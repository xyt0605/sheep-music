# ğŸš€ Sheep Music ä¸€é”®éƒ¨ç½²å‘½ä»¤

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. ç¡®è®¤ GitHub ä»“åº“åœ°å€

å°†ä»¥ä¸‹å‘½ä»¤ä¸­çš„ `ä½ çš„ç”¨æˆ·å` æ›¿æ¢ä¸ºä½ çš„ GitHub ç”¨æˆ·åï¼š

```
https://github.com/ä½ çš„ç”¨æˆ·å/sheep-music.git
```

### 2. ç¡®è®¤æœåŠ¡å™¨ IP

è®°å½•ä½ çš„é˜¿é‡Œäº‘æœåŠ¡å™¨å…¬ç½‘ IPï¼š`___________________`

---

## ç¬¬ä¸€æ­¥ï¼šWSL æ¨é€åˆ° GitHub

### âš ï¸ é‡è¦ï¼šå¦‚æœä¿®æ”¹äº†å‰ç«¯ä»£ç ï¼Œå¿…é¡»å…ˆæ„å»º

```bash
# è¿›å…¥ WSL
wsl

# å¯¼èˆªåˆ°é¡¹ç›®
cd /mnt/d/workspace/java-project/project1/sheep-music

# æ„å»ºå‰ç«¯ï¼ˆå¦‚æœä¿®æ”¹äº†å‰ç«¯ä»£ç ï¼‰
cd front/sheep-music
npm install --legacy-peer-deps  # é¦–æ¬¡æˆ–ä¾èµ–æ›´æ–°æ—¶
npm run build
cd ../..
```

### æ¨é€åˆ° GitHub

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
git add .
git commit -m "éƒ¨ç½²ç‰ˆæœ¬ - $(date '+%Y-%m-%d %H:%M:%S')"
git push

# å¦‚æœæ˜¯é¦–æ¬¡æ¨é€ï¼Œå…ˆæ‰§è¡Œè¿™ä¸ªï¼ˆæ›¿æ¢ä½ çš„ GitHub ä»“åº“åœ°å€ï¼‰
# git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/sheep-music.git
# git push -u origin main
```

---

## ç¬¬äºŒæ­¥ï¼šé˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²

### é¦–æ¬¡éƒ¨ç½²ï¼ˆå®Œæ•´ç‰ˆï¼‰

è¿æ¥åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨åï¼Œå¤åˆ¶ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œï¼š

```bash
# 1. å®‰è£… Dockerï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
curl -fsSL https://get.docker.com -o get-docker.sh && sudo sh get-docker.sh && sudo apt install docker-compose-plugin -y && sudo usermod -aG docker $USER

# é‡æ–°ç™»å½•åç»§ç»­

# 2. å…‹éš†é¡¹ç›®ï¼ˆæ›¿æ¢ä½ çš„ GitHub ä»“åº“åœ°å€ï¼‰
cd ~ && git clone https://github.com/ä½ çš„ç”¨æˆ·å/sheep-music.git && cd sheep-music

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp env.template .env && nano .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š
# MYSQL_ROOT_PASSWORD=ä½ çš„å¼ºå¯†ç 
# MYSQL_PASSWORD=ä½ çš„MySQLå¯†ç 
# JWT_SECRET=è‡³å°‘32ä½çš„éšæœºå­—ç¬¦ä¸²
# ä¿å­˜ï¼šCtrl+Xï¼Œç„¶å Yï¼Œç„¶å Enter

# 4. éƒ¨ç½²é¡¹ç›®
chmod +x server-deploy.sh deploy.sh && bash server-deploy.sh
```

### æ›´æ–°éƒ¨ç½²ï¼ˆç®€åŒ–ç‰ˆï¼‰

å¦‚æœé¡¹ç›®å·²å­˜åœ¨ï¼Œåªéœ€æ‰§è¡Œï¼š

```bash
cd ~/sheep-music && git pull && docker compose down && docker compose up -d --build
```

---

## ç¬¬ä¸‰æ­¥ï¼šé…ç½®é˜²ç«å¢™

### Ubuntu/Debian æœåŠ¡å™¨

```bash
sudo ufw allow 80/tcp && sudo ufw allow 443/tcp && sudo ufw allow 8080/tcp && sudo ufw enable && sudo ufw status
```

### CentOS/RHEL æœåŠ¡å™¨

```bash
sudo firewall-cmd --permanent --add-port=80/tcp && sudo firewall-cmd --permanent --add-port=443/tcp && sudo firewall-cmd --permanent --add-port=8080/tcp && sudo firewall-cmd --reload
```

### é˜¿é‡Œäº‘å®‰å…¨ç»„

åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°æ‰‹åŠ¨é…ç½®ï¼š
1. ECS å®ä¾‹ â†’ å®‰å…¨ç»„é…ç½®
2. æ·»åŠ å…¥æ–¹å‘è§„åˆ™ï¼šç«¯å£ 80ã€443ã€8080

---

## ç¬¬å››æ­¥ï¼šéªŒè¯éƒ¨ç½²

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# æµ‹è¯•æœåŠ¡
curl http://localhost
curl http://localhost:8080

# è·å–å…¬ç½‘ IP
curl ifconfig.me
```

è®¿é—®ï¼š
- å‰ç«¯ï¼š`http://ä½ çš„æœåŠ¡å™¨IP`
- åç«¯ï¼š`http://ä½ çš„æœåŠ¡å™¨IP:8080`

---

## ğŸ”„ æ—¥å¸¸æ›´æ–°æµç¨‹

### 1. æœ¬åœ°æ¨é€ï¼ˆWSLï¼‰

```bash
cd /mnt/d/workspace/java-project/project1/sheep-music
git add .
git commit -m "æ›´æ–°å†…å®¹"
git push
```

### 2. æœåŠ¡å™¨æ›´æ–°

```bash
cd ~/sheep-music
git pull
docker compose down
docker compose up -d --build
```

---

## ğŸ› ï¸ å¸¸ç”¨è¿ç»´å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f mysql

# é‡å¯æœåŠ¡
docker compose restart

# åœæ­¢æœåŠ¡
docker compose down

# å¤‡ä»½æ•°æ®åº“
docker exec sheep-music-mysql mysqldump -u root -p sheepmusic > backup_$(date +%Y%m%d).sql

# è¿›å…¥æ•°æ®åº“
docker exec -it sheep-music-mysql mysql -u root -p

# æ¸…ç† Docker èµ„æº
docker system prune -a
```

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### å®¹å™¨å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker compose logs backend
docker compose logs frontend

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tulpn | grep :80
sudo netstat -tulpn | grep :8080
```

### æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# è¿›å…¥æ•°æ®åº“æ£€æŸ¥
docker exec -it sheep-music-mysql mysql -u root -p
SHOW DATABASES;
USE sheepmusic;
SHOW TABLES;
```

### é‡æ–°éƒ¨ç½²

```bash
# å®Œå…¨æ¸…ç†åé‡æ–°éƒ¨ç½²
cd ~/sheep-music
docker compose down -v
docker compose up -d --build
```

---

## ğŸ“ ç¯å¢ƒå˜é‡æ¨¡æ¿

åˆ›å»º `.env` æ–‡ä»¶æ—¶ä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ï¼š

```env
# MySQL é…ç½®
MYSQL_ROOT_PASSWORD=ä½ çš„å¼ºå¯†ç 123!@#
MYSQL_DATABASE=sheepmusic
MYSQL_USER=sheepmusic
MYSQL_PASSWORD=ä½ çš„MySQLå¯†ç 456!@#

# JWT å¯†é’¥ï¼ˆå¿…é¡»ä¿®æ”¹ï¼è‡³å°‘32ä½ï¼‰
JWT_SECRET=abcdefghijklmnopqrstuvwxyz123456

# é˜¿é‡Œäº‘ OSSï¼ˆå¯é€‰ï¼Œå¦‚æœä¸ä½¿ç”¨å¯ä»¥ç•™ç©ºï¼‰
ALIYUN_OSS_ACCESS_KEY_ID=
ALIYUN_OSS_ACCESS_KEY_SECRET=
ALIYUN_OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com
ALIYUN_OSS_BUCKET_NAME=
ALIYUN_OSS_URL_PREFIX=
```

---

## âš¡ è¶…çº§å¿«é€Ÿéƒ¨ç½²ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

### WSL æ¨é€

```bash
wsl -e bash -c "cd /mnt/d/workspace/java-project/project1/sheep-music && git add . && git commit -m 'deploy $(date +%Y%m%d_%H%M%S)' && git push"
```

### æœåŠ¡å™¨éƒ¨ç½²

```bash
cd ~/sheep-music && git pull && docker compose down && docker compose up -d --build && docker compose logs -f
```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

1. æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š`QUICK_DEPLOY.md`
2. æŸ¥çœ‹éƒ¨ç½²æ­¥éª¤ï¼š`DEPLOYMENT_STEPS.md`
3. æŸ¥çœ‹æ£€æŸ¥æ¸…å•ï¼š`DEPLOYMENT_CHECKLIST.md`
4. æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker compose logs -f`

---

## âœ… éƒ¨ç½²æˆåŠŸæ ‡å¿—

å½“ä½ çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼š

```
âœ“ å‰ç«¯æœåŠ¡æ­£å¸¸
âœ“ åç«¯æœåŠ¡æ­£å¸¸
ğŸ‰ éƒ¨ç½²å®Œæˆï¼
```

è®¿é—® `http://ä½ çš„æœåŠ¡å™¨IP` åº”è¯¥èƒ½çœ‹åˆ°ç½‘ç«™é¦–é¡µã€‚

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰
