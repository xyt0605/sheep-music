# 📋 部署前检查清单

在开始部署前，请确保完成以下检查项：

## ✅ 本地环境检查

### Git 配置

- [ ] 已安装 Git
- [ ] 已配置 Git 用户信息
  ```bash
  git config --global user.name "你的名字"
  git config --global user.email "你的邮箱"
  ```
- [ ] 已创建 GitHub 仓库
- [ ] 已获取 GitHub 仓库地址

### WSL 环境

- [ ] 已安装 WSL
- [ ] 可以在 WSL 中访问项目目录
- [ ] WSL 中已安装 Git

### 项目文件

- [ ] 项目代码已完成并测试
- [ ] 前端已构建（`front/sheep-music/dist` 目录存在）
- [ ] 后端代码已编译通过
- [ ] 数据库初始化脚本存在（`back/music-project/database.sql`）

---

## ✅ GitHub 准备

### 仓库设置

- [ ] 已在 GitHub 创建新仓库
- [ ] 仓库名称：`sheep-music`（或其他名称）
- [ ] 仓库类型：Public 或 Private
- [ ] 已记录仓库地址：`https://github.com/用户名/仓库名.git`

### 本地 Git 配置

- [ ] 已初始化 Git 仓库（`git init`）
- [ ] 已添加远程仓库（`git remote add origin`）
- [ ] 已测试推送权限

---

## ✅ 阿里云服务器准备

### 服务器基本信息

- [ ] 已购买阿里云 ECS 实例
- [ ] 已记录服务器公网 IP：`___________________`
- [ ] 已记录服务器登录用户名：`___________________`
- [ ] 可以通过 SSH 或 Workbench 连接服务器

### 服务器环境

- [ ] 操作系统：Ubuntu 20.04+ / CentOS 7+ / Debian 10+
- [ ] 已安装 Docker
  ```bash
  docker --version
  ```
- [ ] 已安装 Docker Compose
  ```bash
  docker compose version
  ```
- [ ] 已安装 Git
  ```bash
  git --version
  ```
- [ ] 当前用户已加入 docker 组
  ```bash
  sudo usermod -aG docker $USER
  ```

### 服务器资源

- [ ] CPU：至少 2 核
- [ ] 内存：至少 4GB
- [ ] 磁盘：至少 20GB 可用空间
- [ ] 带宽：至少 1Mbps

---

## ✅ 网络配置

### 防火墙规则

- [ ] 服务器防火墙已开放端口 80
- [ ] 服务器防火墙已开放端口 443
- [ ] 服务器防火墙已开放端口 8080

验证命令：
```bash
sudo ufw status  # Ubuntu/Debian
sudo firewall-cmd --list-all  # CentOS/RHEL
```

### 阿里云安全组

- [ ] 已配置安全组规则
- [ ] 入方向规则：允许端口 80（HTTP）
- [ ] 入方向规则：允许端口 443（HTTPS）
- [ ] 入方向规则：允许端口 8080（后端 API）

---

## ✅ 环境变量配置

### 必需配置项

- [ ] MySQL root 密码（强密码）
- [ ] MySQL 数据库名称：`sheepmusic`
- [ ] MySQL 用户名：`sheepmusic`
- [ ] MySQL 用户密码（强密码）
- [ ] JWT 密钥（至少 32 位随机字符串）

### 可选配置项

- [ ] 阿里云 OSS Access Key ID
- [ ] 阿里云 OSS Access Key Secret
- [ ] 阿里云 OSS Endpoint
- [ ] 阿里云 OSS Bucket Name
- [ ] 阿里云 OSS URL Prefix

### 配置文件

- [ ] 已创建 `.env` 文件
- [ ] 已填写所有必需配置
- [ ] 已验证配置格式正确

---

## ✅ 前端配置

### API 地址配置

- [ ] 已配置 `front/sheep-music/.env.production`
- [ ] API 地址已设置为服务器公网 IP
  ```env
  VITE_API_BASE_URL=http://你的服务器IP:8080
  ```

### 构建检查

- [ ] 前端已构建（`npm run build`）
- [ ] `dist` 目录存在且包含文件
- [ ] 构建无错误

---

## ✅ 后端配置

### 数据库配置

- [ ] 数据库初始化脚本存在
- [ ] SQL 文件格式正确
- [ ] 表结构完整

### 应用配置

- [ ] `application.yml` 配置正确
- [ ] 数据库连接配置正确
- [ ] 端口配置正确（9000）

---

## ✅ Docker 配置

### Dockerfile 检查

- [ ] 前端 Dockerfile 存在
- [ ] 后端 Dockerfile 存在
- [ ] Dockerfile 语法正确

### Docker Compose 检查

- [ ] `docker-compose.yml` 存在
- [ ] 服务配置正确（mysql, backend, frontend）
- [ ] 端口映射正确
- [ ] 卷挂载配置正确
- [ ] 网络配置正确

---

## ✅ 部署脚本检查

### 脚本文件

- [ ] `push-to-github.sh` 存在
- [ ] `server-deploy.sh` 存在
- [ ] `deploy.sh` 存在
- [ ] 脚本有执行权限（`chmod +x`）

---

## ✅ 备份计划

### 数据备份

- [ ] 已制定数据库备份策略
- [ ] 已了解备份命令
- [ ] 已测试备份和恢复流程

### 代码备份

- [ ] 代码已推送到 GitHub
- [ ] 已创建版本标签（可选）

---

## ✅ 测试计划

### 本地测试

- [ ] 前端功能测试通过
- [ ] 后端 API 测试通过
- [ ] 数据库连接测试通过

### 部署后测试

- [ ] 前端页面可访问
- [ ] 后端 API 可访问
- [ ] 用户注册功能正常
- [ ] 用户登录功能正常
- [ ] 核心业务功能正常

---

## ✅ 文档准备

### 部署文档

- [ ] 已阅读 `QUICK_DEPLOY.md`
- [ ] 已阅读 `DEPLOYMENT_STEPS.md`
- [ ] 已阅读 `部署说明.txt`

### 运维文档

- [ ] 已了解常用运维命令
- [ ] 已了解故障排查方法
- [ ] 已了解日志查看方法

---

## ✅ 安全检查

### 密码安全

- [ ] 所有密码都是强密码（至少 12 位，包含大小写字母、数字、特殊字符）
- [ ] 密码未硬编码在代码中
- [ ] `.env` 文件已加入 `.gitignore`

### 访问控制

- [ ] 数据库不对外开放（仅容器内访问）
- [ ] 敏感端口已限制访问
- [ ] SSH 端口已修改（可选但推荐）

### HTTPS 配置

- [ ] 已准备 SSL 证书（可选）
- [ ] 已配置 HTTPS（可选）

---

## ✅ 监控和日志

### 日志配置

- [ ] 已配置应用日志
- [ ] 已了解日志查看方法
- [ ] 已配置日志轮转（可选）

### 监控配置

- [ ] 已了解容器状态查看方法
- [ ] 已了解资源使用查看方法

---

## 🎯 部署前最终确认

在开始部署前，请再次确认：

1. [ ] 所有检查项都已完成
2. [ ] 已备份重要数据
3. [ ] 已准备好回滚方案
4. [ ] 已通知相关人员
5. [ ] 选择合适的部署时间（建议非高峰期）

---

## 📞 紧急联系方式

如果部署过程中遇到问题：

1. **查看日志**：`docker compose logs -f`
2. **检查状态**：`docker compose ps`
3. **查看文档**：`QUICK_DEPLOY.md`
4. **回滚操作**：`docker compose down`

---

## ✨ 部署成功后

- [ ] 验证所有功能正常
- [ ] 记录部署时间和版本
- [ ] 更新部署文档
- [ ] 通知相关人员
- [ ] 监控系统运行状态

---

**祝部署顺利！** 🚀

---

## 📝 部署记录

**部署日期**：___________________

**部署人员**：___________________

**服务器 IP**：___________________

**GitHub 仓库**：___________________

**部署版本**：___________________

**备注**：
___________________________________________________________________________
___________________________________________________________________________
___________________________________________________________________________
