import{r as a,d as s,m as l,q as e,H as t,t as i,B as o,a8 as r,D as n,A as c,F as u,G as d,Y as v,am as m,al as p,u as g,L as y}from"./vue-vendor-BzZaYQKc.js";import{u as f}from"./player-BodKjA0D.js";import{_ as k,u as h}from"./index-Cb8xoRiw.js";import{a as _}from"./artist-B-rHTsNg.js";import{b as C}from"./song-C8TMBuSO.js";import{b as j,t as b}from"./favorite-CBOsHs95.js";import{P as w,L as z,a4 as x,aj as P,Y as S,a3 as F,ak as L,Z as A,a7 as q}from"./element-plus-CCPVPfgN.js";import{P as V}from"./PlaylistSelector-BQ_G-bWe.js";import"./request-76E38DvM.js";import"./PlaylistCover-D3NetioR.js";const $={class:"artist-detail"},D={key:0,class:"loading-container"},M={key:1,class:"artist-content"},N={class:"artist-card"},Y={class:"artist-avatar"},B=["src"],G={class:"artist-info"},H={class:"artist-name"},I={class:"artist-meta"},R={key:0,class:"artist-description"},T={class:"artist-actions"},U={class:"songs-section"},Z={class:"section-header"},E={key:0,class:"song-list"},J=["onClick"],K={class:"song-index"},O=["src"],Q={class:"song-info"},W={class:"song-name"},X={class:"song-meta"},aa={key:0,class:"album-name"},sa={class:"song-duration"},la={class:"song-play-count"},ea={class:"song-actions"},ta={key:1,class:"empty-songs"},ia={key:2,class:"error-state"},oa=k({__name:"ArtistDetail",setup(k){const oa=m(),ra=p(),na=f(),ca=h(),ua=a(!0),da=a(null),va=a([]),ma=a({}),pa=a(!1),ga=a(null),ya=async()=>{try{const a=await _(oa.params.id);200===a.code&&(da.value=a.data)}catch(a){console.error("加载歌手信息失败:",a),z.error("加载歌手信息失败")}},fa=async()=>{try{const a=await C(oa.params.id);200===a.code&&(va.value=a.data||[])}catch(a){console.error("加载歌曲列表失败:",a),z.error("加载歌曲列表失败")}},ka=async()=>{ua.value=!0,await Promise.all([ya(),fa()]),await(async()=>{if(ca.isLogin&&0!==va.value.length)try{const a=va.value.map(a=>a.id),s=await j(a);200===s.code&&(ma.value=s.data||{})}catch(a){console.error("加载收藏状态失败:",a)}})(),ua.value=!1},ha=()=>{va.value.length>0&&(na.play(va.value[0],va.value),z.success("开始播放"))},_a=a=>{na.play(a,va.value)},Ca=a=>{if(!a)return"--:--";return`${Math.floor(a/60)}:${(a%60).toString().padStart(2,"0")}`},ja=()=>{ra.back()},ba=()=>{};return s(()=>{ka()}),(a,s)=>{const m=r("el-icon"),p=r("el-tag"),f=r("el-button"),k=r("el-empty"),h=r("el-result");return e(),l("div",$,[ua.value?(e(),l("div",D,[t(m,{class:"is-loading"},{default:o(()=>[t(g(x))]),_:1}),s[1]||(s[1]=i("p",null,"加载中...",-1))])):da.value?(e(),l("div",M,[i("div",N,[i("div",Y,[i("img",{src:da.value.avatar||"https://via.placeholder.com/200?text=Artist",alt:"歌手头像"},null,8,B)]),i("div",G,[i("h1",H,w(da.value.name),1),i("div",I,[da.value.region?(e(),c(p,{key:0,type:"info",size:"large"},{default:o(()=>[t(m,null,{default:o(()=>[t(g(P))]),_:1}),u(" "+w(da.value.region),1)]),_:1})):n("",!0),t(p,{type:"success",size:"large"},{default:o(()=>[t(m,null,{default:o(()=>[t(g(S))]),_:1}),u(" "+w(va.value.length)+" 首歌曲 ",1)]),_:1})]),da.value.description?(e(),l("p",R,w(da.value.description),1)):n("",!0),i("div",T,[t(f,{type:"primary",size:"large",disabled:0===va.value.length,onClick:ha},{default:o(()=>[t(m,null,{default:o(()=>[t(g(F))]),_:1}),s[2]||(s[2]=u(" 播放全部 ",-1))]),_:1},8,["disabled"]),t(f,{size:"large",onClick:ja},{default:o(()=>[t(m,null,{default:o(()=>[t(g(L))]),_:1}),s[3]||(s[3]=u(" 返回 ",-1))]),_:1})])])]),i("div",U,[i("div",Z,[i("h2",null,[t(m,null,{default:o(()=>[t(g(A))]),_:1}),s[4]||(s[4]=u(" 歌曲列表 ",-1))])]),va.value.length>0?(e(),l("div",E,[(e(!0),l(d,null,v(va.value,(a,s)=>{return e(),l("div",{key:a.id,class:"song-item",onClick:s=>_a(a)},[i("div",K,w(s+1),1),i("img",{src:a.cover||"https://via.placeholder.com/60?text=Music",class:"song-cover"},null,8,O),i("div",Q,[i("div",W,w(a.title),1),i("div",X,[a.albumName?(e(),l("span",aa,[t(m,null,{default:o(()=>[t(g(q))]),_:1}),u(" "+w(a.albumName),1)])):n("",!0),i("span",sa,w(Ca(a.duration)),1)])]),i("div",la,[t(m,null,{default:o(()=>[t(g(S))]),_:1}),u(" "+w((r=a.playCount,r>=1e4?(r/1e4).toFixed(1)+"万":r||0)),1)]),i("div",ea,[t(f,{icon:"CaretRight",circle:"",size:"small",onClick:y(s=>_a(a),["stop"]),title:"播放"},null,8,["onClick"]),t(f,{icon:"Plus",circle:"",size:"small",onClick:y(s=>(a=>{na.addToPlaylist(a),z.success(`已添加到播放列表: ${a.title}`)})(a),["stop"]),title:"添加到播放列表"},null,8,["onClick"]),t(f,{icon:"FolderAdd",circle:"",size:"small",onClick:y(s=>(a=>{if(!ca.isLogin)return z.warning("请先登录"),void ra.push("/login");ga.value=a,pa.value=!0})(a.id),["stop"]),title:"添加到歌单"},null,8,["onClick"]),t(f,{icon:ma.value[a.id]?"StarFilled":"Star",circle:"",size:"small",type:ma.value[a.id]?"danger":"",onClick:y(s=>(async a=>{if(!ca.isLogin)return z.warning("请先登录"),void ra.push("/login");try{const s=await b(a);if(200===s.code){const l=s.data.isFavorite;ma.value[a]=l,z.success(l?"收藏成功":"取消收藏成功")}else z.error(s.message||"操作失败")}catch(s){console.error("收藏操作失败:",s),z.error("操作失败，请稍后重试")}})(a.id),["stop"]),title:"收藏"},null,8,["icon","type","onClick"])])],8,J);var r}),128))])):(e(),l("div",ta,[t(k,{description:"该歌手暂无歌曲"})]))])])):(e(),l("div",ia,[t(h,{icon:"error",title:"加载失败","sub-title":"无法获取歌手信息"},{extra:o(()=>[t(f,{type:"primary",onClick:ja},{default:o(()=>[...s[5]||(s[5]=[u("返回",-1)])]),_:1})]),_:1})])),t(V,{modelValue:pa.value,"onUpdate:modelValue":s[0]||(s[0]=a=>pa.value=a),"song-id":ga.value,onSuccess:ba},null,8,["modelValue","song-id"])])}}},[["__scopeId","data-v-5476b56c"]]);export{oa as default};
