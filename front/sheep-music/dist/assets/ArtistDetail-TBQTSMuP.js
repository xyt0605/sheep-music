import{_ as J,v as K,f as O,g as f,i as W,c,o as r,d as e,a,w as i,r as g,k as F,t as d,B as X,e as v,F as Y,l as Z,L as tt,E as u,aa as et,u as st,Q as m,I as at,ab as ot,q as B,H as lt,ac as it,D as nt,R as rt,s as k}from"./index-CU8TO-n3.js";import{a as ct}from"./artist-DBBivPJo.js";import{b as dt,t as ut}from"./favorite-Czb6jsZK.js";import{P as _t}from"./PlaylistSelector-BHFtEt-3.js";import"./playlist-CGieJ7gF.js";import"./PlaylistCover-h1E9Fxsc.js";const vt={class:"artist-detail"},mt={key:0,class:"loading-container"},pt={key:1,class:"artist-content"},ft={class:"artist-card"},gt={class:"artist-avatar"},yt=["src"],ht={class:"artist-info"},kt={class:"artist-name"},Ct={class:"artist-meta"},St={key:0,class:"artist-description"},bt={class:"artist-actions"},wt={class:"songs-section"},At={class:"section-header"},Ft={key:0,class:"song-list"},Pt=["onClick"],xt={class:"song-index"},zt=["src"],Vt={class:"song-info"},$t={class:"song-name"},Bt={class:"song-meta"},Dt={key:0,class:"album-name"},Lt={class:"song-duration"},Nt={class:"song-play-count"},Tt={class:"song-actions"},Mt={key:1,class:"empty-songs"},Rt={key:2,class:"error-state"},Et="/default-artist.svg",It="/default-cover.svg",Ut={__name:"ArtistDetail",setup(qt){const P=tt(),C=st(),S=K(),b=O(),w=f(!0),_=f(null),n=f([]),y=f({}),A=f(!1),x=f(null),D=async()=>{try{const t=await ct(P.params.id);t.code===200&&(_.value=t.data)}catch(t){console.error("加载歌手信息失败:",t),u.error("加载歌手信息失败")}},L=async()=>{try{const t=await et(P.params.id);t.code===200&&(n.value=t.data||[])}catch(t){console.error("加载歌曲列表失败:",t),u.error("加载歌曲列表失败")}},N=async()=>{if(!(!b.isLogin||n.value.length===0))try{const t=n.value.map(l=>l.id),s=await dt(t);s.code===200&&(y.value=s.data||{})}catch(t){console.error("加载收藏状态失败:",t)}},T=async t=>{if(!b.isLogin){u.warning("请先登录"),C.push("/login");return}try{const s=await ut(t);if(s.code===200){const l=s.data.isFavorite;y.value[t]=l,u.success(l?"收藏成功":"取消收藏成功")}else u.error(s.message||"操作失败")}catch(s){console.error("收藏操作失败:",s),u.error("操作失败，请稍后重试")}},M=async()=>{w.value=!0,await Promise.all([D(),L()]),await N(),w.value=!1},R=()=>{n.value.length>0&&(S.play(n.value[0],n.value),u.success("开始播放"))},z=t=>{S.play(t,n.value)},E=t=>{S.addToPlaylist(t),u.success(`已添加到播放列表: ${t.title}`)},I=t=>{if(!t)return"--:--";const s=Math.floor(t/60),l=t%60;return`${s}:${l.toString().padStart(2,"0")}`},U=t=>t>=1e4?(t/1e4).toFixed(1)+"万":t||0,V=()=>{C.back()},q=t=>{if(!b.isLogin){u.warning("请先登录"),C.push("/login");return}x.value=t,A.value=!0},H=()=>{};return W(()=>{M()}),(t,s)=>{const l=g("el-icon"),$=g("el-tag"),p=g("el-button"),Q=g("el-empty"),j=g("el-result");return r(),c("div",vt,[w.value?(r(),c("div",mt,[e(l,{class:"is-loading"},{default:i(()=>[e(m(at))]),_:1}),s[1]||(s[1]=a("p",null,"加载中...",-1))])):_.value?(r(),c("div",pt,[a("div",ft,[a("div",gt,[a("img",{src:_.value.avatar||Et,alt:"歌手头像"},null,8,yt)]),a("div",ht,[a("h1",kt,d(_.value.name),1),a("div",Ct,[_.value.region?(r(),X($,{key:0,type:"info",size:"large"},{default:i(()=>[e(l,null,{default:i(()=>[e(m(ot))]),_:1}),v(" "+d(_.value.region),1)]),_:1})):F("",!0),e($,{type:"success",size:"large"},{default:i(()=>[e(l,null,{default:i(()=>[e(m(B))]),_:1}),v(" "+d(n.value.length)+" 首歌曲 ",1)]),_:1})]),_.value.description?(r(),c("p",St,d(_.value.description),1)):F("",!0),a("div",bt,[e(p,{type:"primary",size:"large",disabled:n.value.length===0,onClick:R},{default:i(()=>[e(l,null,{default:i(()=>[e(m(lt))]),_:1}),s[2]||(s[2]=v(" 播放全部 ",-1))]),_:1},8,["disabled"]),e(p,{size:"large",onClick:V},{default:i(()=>[e(l,null,{default:i(()=>[e(m(it))]),_:1}),s[3]||(s[3]=v(" 返回 ",-1))]),_:1})])])]),a("div",wt,[a("div",At,[a("h2",null,[e(l,null,{default:i(()=>[e(m(nt))]),_:1}),s[4]||(s[4]=v(" 歌曲列表 ",-1))])]),n.value.length>0?(r(),c("div",Ft,[(r(!0),c(Y,null,Z(n.value,(o,G)=>(r(),c("div",{key:o.id,class:"song-item",onClick:h=>z(o)},[a("div",xt,d(G+1),1),a("img",{src:o.cover||It,class:"song-cover"},null,8,zt),a("div",Vt,[a("div",$t,d(o.title),1),a("div",Bt,[o.albumName?(r(),c("span",Dt,[e(l,null,{default:i(()=>[e(m(rt))]),_:1}),v(" "+d(o.albumName),1)])):F("",!0),a("span",Lt,d(I(o.duration)),1)])]),a("div",Nt,[e(l,null,{default:i(()=>[e(m(B))]),_:1}),v(" "+d(U(o.playCount)),1)]),a("div",Tt,[e(p,{icon:"CaretRight",circle:"",size:"small",onClick:k(h=>z(o),["stop"]),title:"播放"},null,8,["onClick"]),e(p,{icon:"Plus",circle:"",size:"small",onClick:k(h=>E(o),["stop"]),title:"添加到播放列表"},null,8,["onClick"]),e(p,{icon:"FolderAdd",circle:"",size:"small",onClick:k(h=>q(o.id),["stop"]),title:"添加到歌单"},null,8,["onClick"]),e(p,{icon:y.value[o.id]?"StarFilled":"Star",circle:"",size:"small",type:y.value[o.id]?"danger":"",onClick:k(h=>T(o.id),["stop"]),title:"收藏"},null,8,["icon","type","onClick"])])],8,Pt))),128))])):(r(),c("div",Mt,[e(Q,{description:"该歌手暂无歌曲"})]))])])):(r(),c("div",Rt,[e(j,{icon:"error",title:"加载失败","sub-title":"无法获取歌手信息"},{extra:i(()=>[e(p,{type:"primary",onClick:V},{default:i(()=>[...s[5]||(s[5]=[v("返回",-1)])]),_:1})]),_:1})])),e(_t,{modelValue:A.value,"onUpdate:modelValue":s[0]||(s[0]=o=>A.value=o),"song-id":x.value,onSuccess:H},null,8,["modelValue","song-id"])])}}},Ot=J(Ut,[["__scopeId","data-v-144a96ac"]]);export{Ot as default};
