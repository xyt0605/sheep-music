import{_ as te,q as oe,g as le,h as _,j as ie,E as d,c as n,o as c,a as s,d as o,A as R,k as V,w as a,m as u,Q as ae,r as A,e as g,a4 as ne,F as N,D as T,R as z,a2 as ce,a5 as re,a6 as de,a7 as ue,u as ve,Y as J,t as v,H as f}from"./index-CxpdbhCZ.js";import{a as _e,b as fe,g as me}from"./recommendation-C8JUp0Qj.js";import{b as pe,t as ge}from"./favorite-DW9fuy8B.js";import{P as he}from"./PlaylistSelector-CyyRmLI4.js";import"./playlist-Dh6I0nmI.js";import"./PlaylistCover-BCsHZ3vp.js";const ye={class:"discover-page"},ke={class:"recommendation-section"},Ce={class:"section-header"},Se={class:"title-group"},Pe={class:"song-grid"},we=["onClick"],ze={class:"song-cover-wrapper"},xe=["src"],Fe={class:"cover-overlay"},Le={class:"song-play-count"},$e={class:"song-info"},be={class:"song-title"},De={class:"song-artist"},Re={class:"song-actions-hover"},Ve={key:0,class:"empty-hint"},Ae={class:"recommendation-section"},Ne={class:"section-header"},Te={class:"title-group"},Ye={class:"song-list"},Me=["onClick"],Be={class:"song-index"},Ee=["src"],Ge={class:"song-info-inline"},je={class:"song-name"},Ie={class:"song-artist-name"},Ue={class:"song-stats"},qe={class:"song-duration"},He={class:"song-actions"},Qe={key:0,class:"empty-hint"},Je={class:"recommendation-section"},Ke={class:"section-header"},Oe={class:"title-group"},We={class:"playlist-grid"},Xe=["onClick"],Ze={class:"playlist-cover-wrapper"},es=["src"],ss={class:"cover-overlay"},ts={class:"playlist-song-count"},os={class:"playlist-info"},ls={class:"playlist-name"},is={class:"playlist-creator"},as={key:0,class:"empty-hint"},K="/default-cover.svg",ns="/default-playlist.svg",cs={__name:"Discover",setup(rs){const x=ve(),Y=oe(),h=le(),y=_([]),k=_(!1),C=_([]),S=_(!1),F=_([]),P=_(!1),m=_({}),L=_(!1),M=_(null);ie(()=>{B(),E(),G()});const B=async()=>{if(!h.isLogin){d.warning("è¯·å…ˆç™»å½•æŸ¥çœ‹æŽ¨è");return}k.value=!0;try{const e=await _e({limit:12});e.code===200?(y.value=e.data||[],await j()):d.error(e.message||"åŠ è½½å¤±è´¥")}catch(e){console.error("åŠ è½½çŒœä½ å–œæ¬¢å¤±è´¥:",e),d.error("åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}finally{k.value=!1}},E=async()=>{if(h.isLogin){S.value=!0;try{const e=await fe({limit:20});e.code===200?(C.value=e.data||[],await j()):d.error(e.message||"åŠ è½½å¤±è´¥")}catch(e){console.error("åŠ è½½ä¸ªæ€§åŒ–æŽ¨èå¤±è´¥:",e)}finally{S.value=!1}}},G=async()=>{if(h.isLogin){P.value=!0;try{const e=await me({limit:12});e.code===200?F.value=e.data||[]:d.error(e.message||"åŠ è½½å¤±è´¥")}catch(e){console.error("åŠ è½½æŽ¨èæ­Œå•å¤±è´¥:",e)}finally{P.value=!1}}},j=async()=>{const e=[...y.value,...C.value];if(e.length!==0)try{const t=e.map(r=>r.id),i=await pe(t);i.code===200&&(m.value=i.data||{})}catch(t){console.error("åŠ è½½æ”¶è—çŠ¶æ€å¤±è´¥:",t)}},O=()=>{B()},W=()=>{E()},X=()=>{G()},$=e=>{const t=[...y.value,...C.value];Y.play(e,t)},I=e=>{Y.addToPlaylist(e),d.success(`å·²æ·»åŠ : ${e.title}`)},U=async e=>{if(!h.isLogin){d.warning("è¯·å…ˆç™»å½•"),x.push("/login");return}try{const t=await ge(e);if(t.code===200){const i=t.data.isFavorite;m.value[e]=i,d.success(i?"æ”¶è—æˆåŠŸ":"å–æ¶ˆæ”¶è—æˆåŠŸ")}else d.error(t.message||"æ“ä½œå¤±è´¥")}catch(t){console.error("æ”¶è—æ“ä½œå¤±è´¥:",t),d.error("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},q=e=>{if(!h.isLogin){d.warning("è¯·å…ˆç™»å½•"),x.push("/login");return}M.value=e,L.value=!0},Z=()=>{},ee=e=>{x.push(`/playlist/${e}`)},H=e=>{var t;return((t=e.artists)==null?void 0:t.map(i=>i.name).join(" / "))||"æœªçŸ¥æ­Œæ‰‹"},Q=e=>e?e>=1e8?(e/1e8).toFixed(1)+"äº¿":e>=1e4?(e/1e4).toFixed(1)+"ä¸‡":e.toString():"0",se=e=>{if(!e)return"--:--";const t=Math.floor(e/60),i=e%60;return`${t}:${i.toString().padStart(2,"0")}`};return(e,t)=>{const i=A("el-icon"),r=A("el-button"),b=A("el-empty"),D=ne("loading");return c(),n("div",ye,[t[10]||(t[10]=s("div",{class:"page-header"},[s("h2",null,"ðŸŽµ å‘çŽ°éŸ³ä¹"),s("p",{class:"subtitle"},"åŸºäºŽä½ çš„å–œå¥½ï¼Œä¸ºä½ æŽ¨èç²¾é€‰å†…å®¹")],-1)),s("div",ke,[s("div",Ce,[s("div",Se,[o(i,{class:"section-icon"},{default:a(()=>[o(u(ae))]),_:1}),t[1]||(t[1]=s("h3",null,"çŒœä½ å–œæ¬¢",-1)),t[2]||(t[2]=s("span",{class:"section-desc"},"æ¯å¤©ä¸ºä½ æ›´æ–°",-1))]),o(r,{text:"",icon:"Refresh",onClick:O,loading:k.value},{default:a(()=>[...t[3]||(t[3]=[g(" æ¢ä¸€æ‰¹ ",-1)])]),_:1},8,["loading"])]),R((c(),n("div",Pe,[(c(!0),n(N,null,T(y.value,l=>(c(),n("div",{key:l.id,class:"song-card",onClick:p=>$(l)},[s("div",ze,[s("img",{src:l.cover||K,class:"song-cover",alt:"å°é¢"},null,8,xe),s("div",Fe,[o(i,{class:"play-icon"},{default:a(()=>[o(u(J))]),_:1})]),s("div",Le,[o(i,null,{default:a(()=>[o(u(z))]),_:1}),g(" "+v(Q(l.playCount)),1)])]),s("div",$e,[s("div",be,v(l.title),1),s("div",De,v(H(l)),1)]),s("div",Re,[o(r,{icon:"Plus",circle:"",size:"small",onClick:f(p=>I(l),["stop"]),title:"æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨"},null,8,["onClick"]),o(r,{icon:"FolderAdd",circle:"",size:"small",onClick:f(p=>q(l.id),["stop"]),title:"æ·»åŠ åˆ°æ­Œå•"},null,8,["onClick"]),o(r,{icon:m.value[l.id]?"StarFilled":"Star",circle:"",size:"small",type:m.value[l.id]?"danger":"",onClick:f(p=>U(l.id),["stop"]),title:"æ”¶è—"},null,8,["icon","type","onClick"])])],8,we))),128))])),[[D,k.value]]),!k.value&&y.value.length===0?(c(),n("div",Ve,[o(b,{description:"æš‚æ— æŽ¨èï¼Œè¯•è¯•å¤šå¬å¬æ­Œæ›²å§~"},{image:a(()=>[o(i,{style:{"font-size":"80px",color:"#ddd"}},{default:a(()=>[o(u(z))]),_:1})]),_:1})])):V("",!0)]),s("div",Ae,[s("div",Ne,[s("div",Te,[o(i,{class:"section-icon"},{default:a(()=>[o(u(ce))]),_:1}),t[4]||(t[4]=s("h3",null,"ä¸ºä½ æŽ¨è",-1)),t[5]||(t[5]=s("span",{class:"section-desc"},"æ ¹æ®ä½ çš„æ”¶è—å’Œæ’­æ”¾ä¹ æƒ¯",-1))]),o(r,{text:"",icon:"Refresh",onClick:W,loading:S.value},{default:a(()=>[...t[6]||(t[6]=[g(" æ¢ä¸€æ‰¹ ",-1)])]),_:1},8,["loading"])]),R((c(),n("div",Ye,[(c(!0),n(N,null,T(C.value,(l,p)=>(c(),n("div",{key:l.id,class:"song-item",onClick:w=>$(l)},[s("div",Be,v(p+1),1),s("img",{src:l.cover||K,class:"song-cover-small",alt:"å°é¢"},null,8,Ee),s("div",Ge,[s("div",je,v(l.title),1),s("div",Ie,v(H(l)),1)]),s("div",Ue,[o(i,null,{default:a(()=>[o(u(z))]),_:1}),g(" "+v(Q(l.playCount)),1)]),s("div",qe,v(se(l.duration)),1),s("div",He,[o(r,{icon:"CaretRight",circle:"",size:"small",onClick:f(w=>$(l),["stop"])},null,8,["onClick"]),o(r,{icon:"Plus",circle:"",size:"small",onClick:f(w=>I(l),["stop"])},null,8,["onClick"]),o(r,{icon:"FolderAdd",circle:"",size:"small",onClick:f(w=>q(l.id),["stop"])},null,8,["onClick"]),o(r,{icon:m.value[l.id]?"StarFilled":"Star",circle:"",size:"small",type:m.value[l.id]?"danger":"",onClick:f(w=>U(l.id),["stop"])},null,8,["icon","type","onClick"])])],8,Me))),128))])),[[D,S.value]]),!S.value&&C.value.length===0?(c(),n("div",Qe,[o(b,{description:"æš‚æ— æŽ¨è"},{image:a(()=>[o(i,{style:{"font-size":"80px",color:"#ddd"}},{default:a(()=>[o(u(re))]),_:1})]),_:1})])):V("",!0)]),s("div",Je,[s("div",Ke,[s("div",Oe,[o(i,{class:"section-icon"},{default:a(()=>[o(u(de))]),_:1}),t[7]||(t[7]=s("h3",null,"ç²¾é€‰æ­Œå•",-1)),t[8]||(t[8]=s("span",{class:"section-desc"},"å‘çŽ°æ›´å¤šå¥½æ­Œ",-1))]),o(r,{text:"",icon:"Refresh",onClick:X,loading:P.value},{default:a(()=>[...t[9]||(t[9]=[g(" æ¢ä¸€æ‰¹ ",-1)])]),_:1},8,["loading"])]),R((c(),n("div",We,[(c(!0),n(N,null,T(F.value,l=>(c(),n("div",{key:l.id,class:"playlist-card",onClick:p=>ee(l.id)},[s("div",Ze,[s("img",{src:l.cover||ns,class:"playlist-cover",alt:"å°é¢"},null,8,es),s("div",ss,[o(i,{class:"play-icon"},{default:a(()=>[o(u(J))]),_:1})]),s("div",ts,[o(i,null,{default:a(()=>[o(u(z))]),_:1}),g(" "+v(l.songCount)+" é¦– ",1)])]),s("div",os,[s("div",ls,v(l.name),1),s("div",is," by "+v(l.userName||"æœªçŸ¥"),1)])],8,Xe))),128))])),[[D,P.value]]),!P.value&&F.value.length===0?(c(),n("div",as,[o(b,{description:"æš‚æ— æŽ¨èæ­Œå•"},{image:a(()=>[o(i,{style:{"font-size":"80px",color:"#ddd"}},{default:a(()=>[o(u(ue))]),_:1})]),_:1})])):V("",!0)]),o(he,{modelValue:L.value,"onUpdate:modelValue":t[0]||(t[0]=l=>L.value=l),"song-id":M.value,onSuccess:Z},null,8,["modelValue","song-id"])])}}},ps=te(cs,[["__scopeId","data-v-5f1fce1e"]]);export{ps as default};
