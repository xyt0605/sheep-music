import{m as s,q as l,t as e,H as o,B as a,a8 as t,D as i,G as n,Y as c,r,d,al as u,F as g,L as v}from"./vue-vendor-BzZaYQKc.js";import{_ as p,u as m}from"./index-Cb8xoRiw.js";import{u as y}from"./player-BodKjA0D.js";import{g as h,a as k}from"./song-C8TMBuSO.js";import{b as S,t as f}from"./favorite-CBOsHs95.js";import{a0 as C,a1 as P,Y as w,P as T,L as A,o as b}from"./element-plus-CCPVPfgN.js";import{P as F}from"./PlaylistSelector-BQ_G-bWe.js";import"./request-76E38DvM.js";import"./PlaylistCover-D3NetioR.js";const j={class:"home"},z={class:"welcome-section"},D={class:"banner-content"},_={class:"banner-icon"},x={class:"banner-action"},R={class:"content-section"},V={class:"section-header"},L={class:"song-list"},M=["onClick"],H=["src"],I={class:"song-info"},$={class:"song-name"},q={class:"song-artist"},Y=["onClick"],B={key:0},G={key:0},U={class:"song-play-count"},E={class:"song-actions"},J={key:0,class:"empty-state"},K={class:"content-section"},N={class:"section-header"},O={class:"song-list"},Q=["onClick"],W={class:"song-index"},X=["src"],Z={class:"song-info"},ss={class:"song-name"},ls={class:"song-artist"},es=["onClick"],os={key:0},as={key:0},ts={class:"song-time"},is={class:"song-actions"},ns={key:0,class:"empty-state"};const cs=p({name:"Home",components:{Headset:w,MagicStick:P,ArrowRight:C,PlaylistSelector:F},setup(){const s=u(),l=m(),e=y(),o=r([]),a=r([]),t=r({}),i=r(!1),n=r(null);return d(async()=>{await(async()=>{try{const s=await h({page:0,size:10});200===s.code&&(o.value=s.data.content||[])}catch(s){console.error("加载热门歌曲失败:",s)}})(),await(async()=>{try{const s=await k({page:0,size:10});200===s.code&&(a.value=s.data.content||[])}catch(s){console.error("加载最新歌曲失败:",s)}})(),await(async()=>{var s,e;if(l.isLogin)try{const s=[...o.value,...a.value],l=[...new Set(s.map(s=>s.id))];if(l.length>0){const s=await S(l);200===s.code&&(t.value=s.data||{})}}catch(i){console.error("加载收藏状态失败:",i),A.error("查询失败: "+((null==(e=null==(s=i.response)?void 0:s.data)?void 0:e.message)||i.message))}})()}),{userStore:l,hotSongs:o,newSongs:a,defaultCover:"https://via.placeholder.com/60?text=Music",favoriteSongs:t,handlePlaySong:s=>{e.play(s,o.value.concat(a.value))},handleAddToPlaylist:s=>{e.addToPlaylist(s),A.success(`已添加到播放列表: ${s.title}`)},handleToggleFavorite:async e=>{if(!l.isLogin)return A.warning("请先登录"),void s.push("/login");try{const s=await f(e);200===s.code&&(t.value[e]=s.data.isFavorite,A.success(s.message||(s.data.isFavorite?"收藏成功":"取消收藏成功")))}catch(o){A.error("操作失败")}},showAddToPlaylistDialog:e=>{if(!l.isLogin)return A.warning("请先登录"),void s.push("/login");n.value=e,i.value=!0},handleAddSuccess:()=>{},playlistSelectorVisible:i,selectedSongId:n,formatPlayCount:s=>s>=1e4?(s/1e4).toFixed(1)+"万":s||0,formatDuration:s=>{if(!s)return"--:--";return`${Math.floor(s/60)}:${(s%60).toString().padStart(2,"0")}`},goToArtist:l=>{l&&s.push(`/artist/${l}`)},goToRank:l=>{s.push({path:"/rank",query:{type:l}})},goToDiscover:()=>{s.push("/discover")}}}},[["render",function(r,d,u,p,m,y){var h;const k=t("MagicStick"),S=t("el-icon"),f=t("ArrowRight"),C=t("el-button"),P=t("el-link"),w=t("Headset"),A=t("el-empty"),F=t("PlaylistSelector");return l(),s("div",j,[e("div",z,[e("h2",null,"你好，"+T((null==(h=p.userStore.userInfo)?void 0:h.nickname)||"音乐爱好者"),1),d[4]||(d[4]=e("p",{class:"welcome-text"}," 欢迎来到 Sheep Music，开始你的音乐之旅 ",-1))]),e("div",{class:"recommend-banner",onClick:d[0]||(d[0]=(...s)=>p.goToDiscover&&p.goToDiscover(...s))},[e("div",D,[e("div",_,[o(S,null,{default:a(()=>[o(k)]),_:1})]),d[6]||(d[6]=e("div",{class:"banner-text"},[e("h3",null,"✨ 发现你的专属音乐"),e("p",null,"基于你的喜好，为你推荐精选歌曲和歌单")],-1)),e("div",x,[o(C,{type:"primary",round:""},{default:a(()=>[d[5]||(d[5]=g(" 立即发现 ",-1)),o(S,{class:"ml-5"},{default:a(()=>[o(f)]),_:1})]),_:1})])])]),e("section",R,[e("div",V,[d[8]||(d[8]=e("h3",null,"🔥 热门歌曲",-1)),o(P,{type:"primary",onClick:d[1]||(d[1]=s=>p.goToRank("hot"))},{default:a(()=>[...d[7]||(d[7]=[g("查看更多 ›",-1)])]),_:1})]),e("div",L,[(l(!0),s(n,null,c(p.hotSongs,(t,r)=>(l(),s("div",{key:t.id,class:"song-item",onClick:s=>p.handlePlaySong(t)},[e("div",{class:b(["song-index",{"top-three":r<3}])},T(r+1),3),e("img",{src:t.cover||p.defaultCover,class:"song-cover"},null,8,H),e("div",I,[e("div",$,T(t.title),1),e("div",q,[(l(!0),s(n,null,c(t.artists||[],(o,a)=>{var c;return l(),s(n,{key:o.id},[e("span",{class:"clickable",onClick:v(s=>p.goToArtist(o.id),["stop"])},T(o.name),9,Y),a<((null==(c=t.artists)?void 0:c.length)||0)-1?(l(),s("span",B," / ")):i("",!0)],64)}),128)),t.artists&&0!==t.artists.length?i("",!0):(l(),s("span",G,"未知歌手"))])]),e("div",U,[o(S,null,{default:a(()=>[o(w)]),_:1}),g(" "+T(p.formatPlayCount(t.playCount)),1)]),e("div",E,[o(C,{icon:"CaretRight",circle:"",size:"small",onClick:v(s=>p.handlePlaySong(t),["stop"]),title:"播放"},null,8,["onClick"]),o(C,{icon:"Plus",circle:"",size:"small",onClick:v(s=>p.handleAddToPlaylist(t),["stop"]),title:"添加到播放列表"},null,8,["onClick"]),o(C,{icon:"FolderAdd",circle:"",size:"small",onClick:v(s=>p.showAddToPlaylistDialog(t.id),["stop"]),title:"添加到歌单"},null,8,["onClick"]),o(C,{icon:p.favoriteSongs[t.id]?"StarFilled":"Star",circle:"",size:"small",type:p.favoriteSongs[t.id]?"danger":"",onClick:v(s=>p.handleToggleFavorite(t.id),["stop"]),title:"收藏"},null,8,["icon","type","onClick"])])],8,M))),128))]),0===p.hotSongs.length?(l(),s("div",J,[o(A,{description:"暂无热门歌曲"})])):i("",!0)]),e("section",K,[e("div",N,[d[10]||(d[10]=e("h3",null,"🎵 新歌速递",-1)),o(P,{type:"primary",onClick:d[2]||(d[2]=s=>p.goToRank("new"))},{default:a(()=>[...d[9]||(d[9]=[g("查看更多 ›",-1)])]),_:1})]),e("div",O,[(l(!0),s(n,null,c(p.newSongs,(a,t)=>(l(),s("div",{key:a.id,class:"song-item",onClick:s=>p.handlePlaySong(a)},[e("div",W,T(t+1),1),e("img",{src:a.cover||p.defaultCover,class:"song-cover"},null,8,X),e("div",Z,[e("div",ss,T(a.title),1),e("div",ls,[(l(!0),s(n,null,c(a.artists||[],(o,t)=>{var c;return l(),s(n,{key:o.id},[e("span",{class:"clickable",onClick:v(s=>p.goToArtist(o.id),["stop"])},T(o.name),9,es),t<((null==(c=a.artists)?void 0:c.length)||0)-1?(l(),s("span",os," / ")):i("",!0)],64)}),128)),a.artists&&0!==a.artists.length?i("",!0):(l(),s("span",as,"未知歌手"))])]),e("div",ts,T(p.formatDuration(a.duration)),1),e("div",is,[o(C,{icon:"CaretRight",circle:"",size:"small",onClick:v(s=>p.handlePlaySong(a),["stop"]),title:"播放"},null,8,["onClick"]),o(C,{icon:"Plus",circle:"",size:"small",onClick:v(s=>p.handleAddToPlaylist(a),["stop"]),title:"添加到播放列表"},null,8,["onClick"]),o(C,{icon:"FolderAdd",circle:"",size:"small",onClick:v(s=>p.showAddToPlaylistDialog(a.id),["stop"]),title:"添加到歌单"},null,8,["onClick"]),o(C,{icon:p.favoriteSongs[a.id]?"StarFilled":"Star",circle:"",size:"small",type:p.favoriteSongs[a.id]?"danger":"",onClick:v(s=>p.handleToggleFavorite(a.id),["stop"]),title:"收藏"},null,8,["icon","type","onClick"])])],8,Q))),128))]),0===p.newSongs.length?(l(),s("div",ns,[o(A,{description:"暂无最新歌曲"})])):i("",!0)]),o(F,{modelValue:p.playlistSelectorVisible,"onUpdate:modelValue":d[3]||(d[3]=s=>p.playlistSelectorVisible=s),"song-id":p.selectedSongId,onSuccess:p.handleAddSuccess},null,8,["modelValue","song-id","onSuccess"])])}],["__scopeId","data-v-3cbd026e"]]);export{cs as default};
