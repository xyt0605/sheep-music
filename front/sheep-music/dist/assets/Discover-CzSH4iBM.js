import{_ as te,v as oe,f as le,g as _,i as ie,E as d,c as n,o as c,a as s,d as o,O as V,k as D,w as a,r as T,P as ae,F as A,l as N,u as ne,Q as u,p as ce,e as m,H as Q,q as z,t as v,s as f,M as re,R as de,S as ue,T as ve}from"./index-CU8TO-n3.js";import{a as _e,b as fe,g as pe}from"./recommendation-DCK9e94Y.js";import{b as ge,t as me}from"./favorite-Czb6jsZK.js";import{P as he}from"./PlaylistSelector-BHFtEt-3.js";import"./playlist-CGieJ7gF.js";import"./PlaylistCover-h1E9Fxsc.js";const ye={class:"discover-page"},ke={class:"recommendation-section"},Ce={class:"section-header"},Se={class:"title-group"},Pe={class:"song-grid"},we=["onClick"],ze={class:"song-cover-wrapper"},xe=["src"],Fe={class:"cover-overlay"},Le={class:"song-play-count"},$e={class:"song-info"},be={class:"song-title"},Re={class:"song-artist"},Ve={class:"song-actions-hover"},De={key:0,class:"empty-hint"},Te={class:"recommendation-section"},Ae={class:"section-header"},Ne={class:"title-group"},Me={class:"song-list"},Ye=["onClick"],Be={class:"song-index"},Ee=["src"],Ge={class:"song-info-inline"},Ie={class:"song-name"},Ue={class:"song-artist-name"},je={class:"song-stats"},qe={class:"song-duration"},He={class:"song-actions"},Oe={key:0,class:"empty-hint"},Qe={class:"recommendation-section"},Je={class:"section-header"},Ke={class:"title-group"},We={class:"playlist-grid"},Xe=["onClick"],Ze={class:"playlist-cover-wrapper"},es=["src"],ss={class:"cover-overlay"},ts={class:"playlist-song-count"},os={class:"playlist-info"},ls={class:"playlist-name"},is={class:"playlist-creator"},as={key:0,class:"empty-hint"},J="/default-cover.svg",ns="/default-playlist.svg",cs={__name:"Discover",setup(rs){const x=ne(),M=oe(),h=le(),y=_([]),k=_(!1),C=_([]),S=_(!1),F=_([]),P=_(!1),p=_({}),L=_(!1),Y=_(null);ie(()=>{B(),E(),G()});const B=async()=>{if(!h.isLogin){d.warning("è¯·å…ˆç™»å½•æŸ¥çœ‹æŽ¨è");return}k.value=!0;try{const e=await _e({limit:12});e.code===200?(y.value=e.data||[],await I()):d.error(e.message||"åŠ è½½å¤±è´¥")}catch(e){console.error("åŠ è½½çŒœä½ å–œæ¬¢å¤±è´¥:",e),d.error("åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}finally{k.value=!1}},E=async()=>{if(h.isLogin){S.value=!0;try{const e=await fe({limit:20});e.code===200?(C.value=e.data||[],await I()):d.error(e.message||"åŠ è½½å¤±è´¥")}catch(e){console.error("åŠ è½½ä¸ªæ€§åŒ–æŽ¨èå¤±è´¥:",e)}finally{S.value=!1}}},G=async()=>{if(h.isLogin){P.value=!0;try{const e=await pe({limit:12});e.code===200?F.value=e.data||[]:d.error(e.message||"åŠ è½½å¤±è´¥")}catch(e){console.error("åŠ è½½æŽ¨èæ­Œå•å¤±è´¥:",e)}finally{P.value=!1}}},I=async()=>{const e=[...y.value,...C.value];if(e.length!==0)try{const t=e.map(r=>r.id),i=await ge(t);i.code===200&&(p.value=i.data||{})}catch(t){console.error("åŠ è½½æ”¶è—çŠ¶æ€å¤±è´¥:",t)}},K=()=>{B()},W=()=>{E()},X=()=>{G()},$=e=>{const t=[...y.value,...C.value];M.play(e,t)},U=e=>{M.addToPlaylist(e),d.success(`å·²æ·»åŠ : ${e.title}`)},j=async e=>{if(!h.isLogin){d.warning("è¯·å…ˆç™»å½•"),x.push("/login");return}try{const t=await me(e);if(t.code===200){const i=t.data.isFavorite;p.value[e]=i,d.success(i?"æ”¶è—æˆåŠŸ":"å–æ¶ˆæ”¶è—æˆåŠŸ")}else d.error(t.message||"æ“ä½œå¤±è´¥")}catch(t){console.error("æ”¶è—æ“ä½œå¤±è´¥:",t),d.error("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},q=e=>{if(!h.isLogin){d.warning("è¯·å…ˆç™»å½•"),x.push("/login");return}Y.value=e,L.value=!0},Z=()=>{},ee=e=>{x.push(`/playlist/${e}`)},H=e=>{var t;return((t=e.artists)==null?void 0:t.map(i=>i.name).join(" / "))||"æœªçŸ¥æ­Œæ‰‹"},O=e=>e?e>=1e8?(e/1e8).toFixed(1)+"äº¿":e>=1e4?(e/1e4).toFixed(1)+"ä¸‡":e.toString():"0",se=e=>{if(!e)return"--:--";const t=Math.floor(e/60),i=e%60;return`${t}:${i.toString().padStart(2,"0")}`};return(e,t)=>{const i=T("el-icon"),r=T("el-button"),b=T("el-empty"),R=ae("loading");return c(),n("div",ye,[t[10]||(t[10]=s("div",{class:"page-header"},[s("h2",null,"ðŸŽµ å‘çŽ°éŸ³ä¹"),s("p",{class:"subtitle"},"åŸºäºŽä½ çš„å–œå¥½ï¼Œä¸ºä½ æŽ¨èç²¾é€‰å†…å®¹")],-1)),s("div",ke,[s("div",Ce,[s("div",Se,[o(i,{class:"section-icon"},{default:a(()=>[o(u(ce))]),_:1}),t[1]||(t[1]=s("h3",null,"çŒœä½ å–œæ¬¢",-1)),t[2]||(t[2]=s("span",{class:"section-desc"},"æ¯å¤©ä¸ºä½ æ›´æ–°",-1))]),o(r,{text:"",icon:"Refresh",onClick:K,loading:k.value},{default:a(()=>[...t[3]||(t[3]=[m(" æ¢ä¸€æ‰¹ ",-1)])]),_:1},8,["loading"])]),V((c(),n("div",Pe,[(c(!0),n(A,null,N(y.value,l=>(c(),n("div",{key:l.id,class:"song-card",onClick:g=>$(l)},[s("div",ze,[s("img",{src:l.cover||J,class:"song-cover",alt:"å°é¢"},null,8,xe),s("div",Fe,[o(i,{class:"play-icon"},{default:a(()=>[o(u(Q))]),_:1})]),s("div",Le,[o(i,null,{default:a(()=>[o(u(z))]),_:1}),m(" "+v(O(l.playCount)),1)])]),s("div",$e,[s("div",be,v(l.title),1),s("div",Re,v(H(l)),1)]),s("div",Ve,[o(r,{icon:"Plus",circle:"",size:"small",onClick:f(g=>U(l),["stop"]),title:"æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨"},null,8,["onClick"]),o(r,{icon:"FolderAdd",circle:"",size:"small",onClick:f(g=>q(l.id),["stop"]),title:"æ·»åŠ åˆ°æ­Œå•"},null,8,["onClick"]),o(r,{icon:p.value[l.id]?"StarFilled":"Star",circle:"",size:"small",type:p.value[l.id]?"danger":"",onClick:f(g=>j(l.id),["stop"]),title:"æ”¶è—"},null,8,["icon","type","onClick"])])],8,we))),128))])),[[R,k.value]]),!k.value&&y.value.length===0?(c(),n("div",De,[o(b,{description:"æš‚æ— æŽ¨èï¼Œè¯•è¯•å¤šå¬å¬æ­Œæ›²å§~"},{image:a(()=>[o(i,{style:{"font-size":"80px",color:"#ddd"}},{default:a(()=>[o(u(z))]),_:1})]),_:1})])):D("",!0)]),s("div",Te,[s("div",Ae,[s("div",Ne,[o(i,{class:"section-icon"},{default:a(()=>[o(u(re))]),_:1}),t[4]||(t[4]=s("h3",null,"ä¸ºä½ æŽ¨è",-1)),t[5]||(t[5]=s("span",{class:"section-desc"},"æ ¹æ®ä½ çš„æ”¶è—å’Œæ’­æ”¾ä¹ æƒ¯",-1))]),o(r,{text:"",icon:"Refresh",onClick:W,loading:S.value},{default:a(()=>[...t[6]||(t[6]=[m(" æ¢ä¸€æ‰¹ ",-1)])]),_:1},8,["loading"])]),V((c(),n("div",Me,[(c(!0),n(A,null,N(C.value,(l,g)=>(c(),n("div",{key:l.id,class:"song-item",onClick:w=>$(l)},[s("div",Be,v(g+1),1),s("img",{src:l.cover||J,class:"song-cover-small",alt:"å°é¢"},null,8,Ee),s("div",Ge,[s("div",Ie,v(l.title),1),s("div",Ue,v(H(l)),1)]),s("div",je,[o(i,null,{default:a(()=>[o(u(z))]),_:1}),m(" "+v(O(l.playCount)),1)]),s("div",qe,v(se(l.duration)),1),s("div",He,[o(r,{icon:"CaretRight",circle:"",size:"small",onClick:f(w=>$(l),["stop"])},null,8,["onClick"]),o(r,{icon:"Plus",circle:"",size:"small",onClick:f(w=>U(l),["stop"])},null,8,["onClick"]),o(r,{icon:"FolderAdd",circle:"",size:"small",onClick:f(w=>q(l.id),["stop"])},null,8,["onClick"]),o(r,{icon:p.value[l.id]?"StarFilled":"Star",circle:"",size:"small",type:p.value[l.id]?"danger":"",onClick:f(w=>j(l.id),["stop"])},null,8,["icon","type","onClick"])])],8,Ye))),128))])),[[R,S.value]]),!S.value&&C.value.length===0?(c(),n("div",Oe,[o(b,{description:"æš‚æ— æŽ¨è"},{image:a(()=>[o(i,{style:{"font-size":"80px",color:"#ddd"}},{default:a(()=>[o(u(de))]),_:1})]),_:1})])):D("",!0)]),s("div",Qe,[s("div",Je,[s("div",Ke,[o(i,{class:"section-icon"},{default:a(()=>[o(u(ue))]),_:1}),t[7]||(t[7]=s("h3",null,"ç²¾é€‰æ­Œå•",-1)),t[8]||(t[8]=s("span",{class:"section-desc"},"å‘çŽ°æ›´å¤šå¥½æ­Œ",-1))]),o(r,{text:"",icon:"Refresh",onClick:X,loading:P.value},{default:a(()=>[...t[9]||(t[9]=[m(" æ¢ä¸€æ‰¹ ",-1)])]),_:1},8,["loading"])]),V((c(),n("div",We,[(c(!0),n(A,null,N(F.value,l=>(c(),n("div",{key:l.id,class:"playlist-card",onClick:g=>ee(l.id)},[s("div",Ze,[s("img",{src:l.cover||ns,class:"playlist-cover",alt:"å°é¢"},null,8,es),s("div",ss,[o(i,{class:"play-icon"},{default:a(()=>[o(u(Q))]),_:1})]),s("div",ts,[o(i,null,{default:a(()=>[o(u(z))]),_:1}),m(" "+v(l.songCount)+" é¦– ",1)])]),s("div",os,[s("div",ls,v(l.name),1),s("div",is," by "+v(l.userName||"æœªçŸ¥"),1)])],8,Xe))),128))])),[[R,P.value]]),!P.value&&F.value.length===0?(c(),n("div",as,[o(b,{description:"æš‚æ— æŽ¨èæ­Œå•"},{image:a(()=>[o(i,{style:{"font-size":"80px",color:"#ddd"}},{default:a(()=>[o(u(ve))]),_:1})]),_:1})])):D("",!0)]),o(he,{modelValue:L.value,"onUpdate:modelValue":t[0]||(t[0]=l=>L.value=l),"song-id":Y.value,onSuccess:Z},null,8,["modelValue","song-id"])])}}},gs=te(cs,[["__scopeId","data-v-5f1fce1e"]]);export{gs as default};
