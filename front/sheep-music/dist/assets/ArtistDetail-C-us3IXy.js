import{_ as Z,q as G,g as J,h as f,j as K,c,o as r,d as e,a,w as i,m as v,Z as O,r as g,k as F,t as d,z as Q,e as m,an as X,R as D,Y as tt,ao as et,W as st,F as at,D as ot,u as lt,a1 as it,E as u,ap as nt,a5 as rt,H as k}from"./index-DgHAayS7.js";import{a as ct}from"./artist-B6Rkkjkw.js";import{b as dt,t as ut}from"./favorite-l6cDJgAy.js";import{P as _t}from"./PlaylistSelector-DyCrpW3z.js";import"./playlist-BdD56kKj.js";import"./PlaylistCover-BPd8dWp8.js";const vt={class:"artist-detail"},mt={key:0,class:"loading-container"},pt={key:1,class:"artist-content"},ft={class:"artist-card"},gt={class:"artist-avatar"},yt=["src"],ht={class:"artist-info"},kt={class:"artist-name"},Ct={class:"artist-meta"},St={key:0,class:"artist-description"},bt={class:"artist-actions"},wt={class:"songs-section"},At={class:"section-header"},Ft={key:0,class:"song-list"},Pt=["onClick"],zt={class:"song-index"},xt=["src"],Vt={class:"song-info"},$t={class:"song-name"},Dt={class:"song-meta"},Bt={key:0,class:"album-name"},Nt={class:"song-duration"},Lt={class:"song-play-count"},Tt={class:"song-actions"},Mt={key:1,class:"empty-songs"},Rt={key:2,class:"error-state"},Et="/default-artist.svg",It="/default-cover.svg",Ut={__name:"ArtistDetail",setup(jt){const P=it(),C=lt(),S=G(),b=J(),w=f(!0),_=f(null),n=f([]),y=f({}),A=f(!1),z=f(null),B=async()=>{try{const t=await ct(P.params.id);t.code===200&&(_.value=t.data)}catch(t){console.error("加载歌手信息失败:",t),u.error("加载歌手信息失败")}},N=async()=>{try{const t=await nt(P.params.id);t.code===200&&(n.value=t.data||[])}catch(t){console.error("加载歌曲列表失败:",t),u.error("加载歌曲列表失败")}},L=async()=>{if(!(!b.isLogin||n.value.length===0))try{const t=n.value.map(l=>l.id),s=await dt(t);s.code===200&&(y.value=s.data||{})}catch(t){console.error("加载收藏状态失败:",t)}},T=async t=>{if(!b.isLogin){u.warning("请先登录"),C.push("/login");return}try{const s=await ut(t);if(s.code===200){const l=s.data.isFavorite;y.value[t]=l,u.success(l?"收藏成功":"取消收藏成功")}else u.error(s.message||"操作失败")}catch(s){console.error("收藏操作失败:",s),u.error("操作失败，请稍后重试")}},M=async()=>{w.value=!0,await Promise.all([B(),N()]),await L(),w.value=!1},R=()=>{n.value.length>0&&(S.play(n.value[0],n.value),u.success("开始播放"))},x=t=>{S.play(t,n.value)},E=t=>{S.addToPlaylist(t),u.success(`已添加到播放列表: ${t.title}`)},I=t=>{if(!t)return"--:--";const s=Math.floor(t/60),l=t%60;return`${s}:${l.toString().padStart(2,"0")}`},U=t=>t>=1e4?(t/1e4).toFixed(1)+"万":t||0,V=()=>{C.back()},j=t=>{if(!b.isLogin){u.warning("请先登录"),C.push("/login");return}z.value=t,A.value=!0},q=()=>{};return K(()=>{M()}),(t,s)=>{const l=g("el-icon"),$=g("el-tag"),p=g("el-button"),H=g("el-empty"),W=g("el-result");return r(),c("div",vt,[w.value?(r(),c("div",mt,[e(l,{class:"is-loading"},{default:i(()=>[e(v(O))]),_:1}),s[1]||(s[1]=a("p",null,"加载中...",-1))])):_.value?(r(),c("div",pt,[a("div",ft,[a("div",gt,[a("img",{src:_.value.avatar||Et,alt:"歌手头像"},null,8,yt)]),a("div",ht,[a("h1",kt,d(_.value.name),1),a("div",Ct,[_.value.region?(r(),Q($,{key:0,type:"info",size:"large"},{default:i(()=>[e(l,null,{default:i(()=>[e(v(X))]),_:1}),m(" "+d(_.value.region),1)]),_:1})):F("",!0),e($,{type:"success",size:"large"},{default:i(()=>[e(l,null,{default:i(()=>[e(v(D))]),_:1}),m(" "+d(n.value.length)+" 首歌曲 ",1)]),_:1})]),_.value.description?(r(),c("p",St,d(_.value.description),1)):F("",!0),a("div",bt,[e(p,{type:"primary",size:"large",disabled:n.value.length===0,onClick:R},{default:i(()=>[e(l,null,{default:i(()=>[e(v(tt))]),_:1}),s[2]||(s[2]=m(" 播放全部 ",-1))]),_:1},8,["disabled"]),e(p,{size:"large",onClick:V},{default:i(()=>[e(l,null,{default:i(()=>[e(v(et))]),_:1}),s[3]||(s[3]=m(" 返回 ",-1))]),_:1})])])]),a("div",wt,[a("div",At,[a("h2",null,[e(l,null,{default:i(()=>[e(v(st))]),_:1}),s[4]||(s[4]=m(" 歌曲列表 ",-1))])]),n.value.length>0?(r(),c("div",Ft,[(r(!0),c(at,null,ot(n.value,(o,Y)=>(r(),c("div",{key:o.id,class:"song-item",onClick:h=>x(o)},[a("div",zt,d(Y+1),1),a("img",{src:o.cover||It,class:"song-cover"},null,8,xt),a("div",Vt,[a("div",$t,d(o.title),1),a("div",Dt,[o.albumName?(r(),c("span",Bt,[e(l,null,{default:i(()=>[e(v(rt))]),_:1}),m(" "+d(o.albumName),1)])):F("",!0),a("span",Nt,d(I(o.duration)),1)])]),a("div",Lt,[e(l,null,{default:i(()=>[e(v(D))]),_:1}),m(" "+d(U(o.playCount)),1)]),a("div",Tt,[e(p,{icon:"CaretRight",circle:"",size:"small",onClick:k(h=>x(o),["stop"]),title:"播放"},null,8,["onClick"]),e(p,{icon:"Plus",circle:"",size:"small",onClick:k(h=>E(o),["stop"]),title:"添加到播放列表"},null,8,["onClick"]),e(p,{icon:"FolderAdd",circle:"",size:"small",onClick:k(h=>j(o.id),["stop"]),title:"添加到歌单"},null,8,["onClick"]),e(p,{icon:y.value[o.id]?"StarFilled":"Star",circle:"",size:"small",type:y.value[o.id]?"danger":"",onClick:k(h=>T(o.id),["stop"]),title:"收藏"},null,8,["icon","type","onClick"])])],8,Pt))),128))])):(r(),c("div",Mt,[e(H,{description:"该歌手暂无歌曲"})]))])])):(r(),c("div",Rt,[e(W,{icon:"error",title:"加载失败","sub-title":"无法获取歌手信息"},{extra:i(()=>[e(p,{type:"primary",onClick:V},{default:i(()=>[...s[5]||(s[5]=[m("返回",-1)])]),_:1})]),_:1})])),e(_t,{modelValue:A.value,"onUpdate:modelValue":s[0]||(s[0]=o=>A.value=o),"song-id":z.value,onSuccess:q},null,8,["modelValue","song-id"])])}}},Jt=Z(Ut,[["__scopeId","data-v-144a96ac"]]);export{Jt as default};
