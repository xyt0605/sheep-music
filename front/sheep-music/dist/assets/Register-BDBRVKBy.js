import{_ as F,c as v,o as x,a as g,d as o,w as t,r as d,e as p,t as y,h as c,i as R,E as w,u as b}from"./index-nrl4pEAu.js";import{r as k}from"./user-DatMwIt3.js";import{G as E}from"./GalaxyFormInput-SPS03oiF.js";import{G}from"./GalaxyButton-DQlzijLn.js";const P={name:"Register",components:{GalaxyFormInput:E,GalaxyButton:G},setup(){const f=b(),r=c(null),u=c(!1),e=R({username:"",password:"",confirmPassword:"",nickname:"",email:""});return{registerFormRef:r,registerForm:e,registerRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度为3-20个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度为6-20个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:(m,s,l)=>{s===""?l(new Error("请再次输入密码")):s!==e.password?l(new Error("两次输入的密码不一致")):l()},trigger:"blur"}],email:[{validator:(m,s,l)=>{s===""||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?l():l(new Error("请输入正确的邮箱格式"))},trigger:"blur"}]},loading:u,handleRegister:async()=>{r.value&&await r.value.validate(async m=>{if(m)try{u.value=!0,await k({username:e.username,password:e.password,nickname:e.nickname||e.username,email:e.email}),w.success("注册成功，请登录"),setTimeout(()=>{f.push("/login")},1e3)}catch(s){w.error(s.message||"注册失败")}finally{u.value=!1}})}}}},B={class:"register-container"},C={class:"register-box"},U={class:"login-link"};function I(f,r,u,e,_,V){const i=d("GalaxyFormInput"),n=d("el-form-item"),m=d("GalaxyButton"),s=d("router-link"),l=d("el-form");return x(),v("div",B,[g("div",C,[r[7]||(r[7]=g("h2",{class:"title"},"Sheep Music",-1)),r[8]||(r[8]=g("p",{class:"subtitle"},"创建新账号",-1)),o(l,{ref:"registerFormRef",model:e.registerForm,rules:e.registerRules,class:"register-form"},{default:t(()=>[o(n,{prop:"username"},{default:t(()=>[o(i,{modelValue:e.registerForm.username,"onUpdate:modelValue":r[0]||(r[0]=a=>e.registerForm.username=a),label:"用户名",name:"reg-username",autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(n,{prop:"password"},{default:t(()=>[o(i,{modelValue:e.registerForm.password,"onUpdate:modelValue":r[1]||(r[1]=a=>e.registerForm.password=a),type:"password",label:"密码",name:"reg-password",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),o(n,{prop:"confirmPassword"},{default:t(()=>[o(i,{modelValue:e.registerForm.confirmPassword,"onUpdate:modelValue":r[2]||(r[2]=a=>e.registerForm.confirmPassword=a),type:"password",label:"确认密码",name:"reg-confirm",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),o(n,{prop:"nickname"},{default:t(()=>[o(i,{modelValue:e.registerForm.nickname,"onUpdate:modelValue":r[3]||(r[3]=a=>e.registerForm.nickname=a),label:"昵称（可选）",name:"reg-nickname",autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(n,{prop:"email"},{default:t(()=>[o(i,{modelValue:e.registerForm.email,"onUpdate:modelValue":r[4]||(r[4]=a=>e.registerForm.email=a),label:"邮箱（可选）",name:"reg-email",autocomplete:"email"},null,8,["modelValue"])]),_:1}),o(n,null,{default:t(()=>[o(m,{loading:e.loading,size:"lg",variant:"primary",class:"register-button",onClick:e.handleRegister},{default:t(()=>[p(y(e.loading?"注册中...":"注册"),1)]),_:1},8,["loading","onClick"])]),_:1}),g("div",U,[r[6]||(r[6]=p(" 已有账号？ ",-1)),o(s,{to:"/login"},{default:t(()=>[...r[5]||(r[5]=[p("立即登录",-1)])]),_:1})])]),_:1},8,["model","rules"])])])}const S=F(P,[["render",I],["__scopeId","data-v-77d64421"]]);export{S as default};
