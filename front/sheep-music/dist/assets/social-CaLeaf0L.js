import{a8 as r,aA as F,h as o,v as g}from"./index-BjdeA3Zu.js";const N=t=>r({url:"/friend/request",method:"post",data:t}),j=t=>r({url:`/friend/accept/${t}`,method:"post"}),D=t=>r({url:`/friend/reject/${t}`,method:"post"}),b=t=>r({url:`/friend/${t}`,method:"delete"}),p=()=>r({url:"/friend/list",method:"get"}),C=()=>r({url:"/friend/requests",method:"get"}),x=t=>r({url:"/friend/search",method:"get",params:{keyword:t}}),H=(t,n)=>r({url:`/friend/${t}/remark`,method:"put",data:{remark:n}}),L=(t,n)=>r({url:`/chat/history/${t}`,method:"get",params:n}),q=()=>r({url:"/chat/conversations",method:"get"}),P=t=>r({url:`/chat/read/all/${t}`,method:"put"}),z=t=>r({url:`/chat/recall/${t}`,method:"post"}),y=()=>r({url:"/chat/unread-count",method:"get"}),R=()=>r({url:"/notification/unread-count",method:"get"}),B=F("social",()=>{const t=o([]),n=o([]),s=o([]),c=o(null),d=o(0),i=o(0),v=g(()=>n.value.length),u=async()=>{try{const e=await p();e.code===200&&(t.value=e.data||[])}catch(e){console.error("加载好友列表失败:",e)}},l=async()=>{try{const e=await C();e.code===200&&(n.value=e.data||[])}catch(e){console.error("加载好友请求失败:",e)}},h=async()=>{try{const e=await q();e.code===200&&(s.value=e.data||[])}catch(e){console.error("加载会话列表失败:",e)}},f=async()=>{try{const e=await y();e.code===200&&(d.value=e.data||0)}catch(e){console.error("获取未读消息数失败:",e)}},m=async()=>{try{const e=await R();e.code===200&&(i.value=e.data||0)}catch(e){console.error("获取未读通知数失败:",e)}};return{friends:t,friendRequests:n,conversations:s,currentChatFriend:c,unreadMessageCount:d,unreadNotificationCount:i,friendRequestCount:v,loadFriends:u,loadFriendRequests:l,loadConversations:h,updateUnreadMessageCount:f,updateUnreadNotificationCount:m,initSocialData:async()=>{await Promise.allSettled([u(),l(),h(),f(),m()])},setCurrentChatFriend:e=>{c.value=e},addFriend:e=>{t.value.find(a=>a.id===e.id)||t.value.push(e)},removeFriend:e=>{t.value=t.value.filter(a=>a.id!==e)},addFriendRequest:e=>{n.value.find(a=>a.id===e.id)||n.value.push(e)},removeFriendRequest:e=>{n.value=n.value.filter(a=>a.id!==e)}}});export{H as a,j as b,N as c,b as d,p as e,L as f,q as g,z as h,P as m,D as r,x as s,B as u};
