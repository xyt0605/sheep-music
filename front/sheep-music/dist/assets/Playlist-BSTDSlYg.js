import{_ as q,F as I,G as M,Q as O,R as G,S as J,c as g,o as c,a as s,d as t,w as o,r,f as Q,g as _,k as j,i as A,E as w,u as K,e as i,q as E,z as F,I as B,J as D,t as f,U as W}from"./index-DUIxZ2bH.js";import{P as X,g as Y,a as Z}from"./PlaylistCover-8S-uaouD.js";import{g as $}from"./recommendation-BYnPSRTG.js";import"./request-C9aqfYyr.js";const ee={name:"PlaylistSquare",components:{PlaylistCover:X,Loading:J,CaretRight:G,User:O,List:M,Headset:I},setup(){const U=K(),a=Q(),H=_("recommend"),e=_(""),m=_(!1),y=_([]),u=_(1),C=_(20),h=_(0),v=_([]),d=_(1),P=_(20),b=_(0),S="https://via.placeholder.com/200?text=Playlist",k=j(()=>a.isLogin),p=async()=>{m.value=!0;try{let l;if(k.value&&!e.value&&u.value===1)try{if(l=await $({limit:C.value}),l.code===200&&l.data&&l.data.length>0){y.value=l.data,h.value=l.data.length,m.value=!1;return}}catch(n){console.log("个性化推荐失败，使用默认推荐:",n)}l=await Y({page:u.value-1,size:C.value,category:e.value||void 0}),l.code===200?(y.value=l.data.content||[],h.value=l.data.totalElements||0):w.warning(l.message||"加载失败")}catch(l){console.error("加载歌单失败:",l),w.error("加载歌单失败，请稍后重试")}finally{m.value=!1}},z=async()=>{m.value=!0;try{const l=await Z({page:d.value-1,size:P.value});l.code===200?(v.value=l.data.content||[],b.value=l.data.totalElements||0):w.warning(l.message||"加载失败")}catch(l){console.error("加载热门歌单失败:",l),w.error("加载热门歌单失败，请稍后重试")}finally{m.value=!1}},R=()=>{u.value=1,H.value==="recommend"&&p()},x=l=>{l==="recommend"?y.value.length===0&&p():l==="hot"&&v.value.length===0&&z()},L=l=>{U.push(`/playlist/${l}`)},V=l=>l?l>=1e4?(l/1e4).toFixed(1)+"万":l:0;return A(()=>{p()}),{activeTab:H,selectedCategory:e,loading:m,playlists:y,currentPage:u,pageSize:C,total:h,hotPlaylists:v,hotCurrentPage:d,hotPageSize:P,hotTotal:b,defaultCover:S,isLogin:k,loadPlaylists:p,loadHotPlaylists:z,handleCategoryChange:R,handleTabChange:x,goToPlaylistDetail:L,formatCount:V}}},te={class:"playlist-square"},ae={class:"category-filter"},le={key:0,class:"loading-container"},oe={key:1,class:"playlist-grid"},ne=["onClick"],se={class:"playlist-cover-wrapper"},re={class:"playlist-overlay"},ie={class:"playlist-info"},de=["title"],ce={class:"playlist-creator"},ue={class:"playlist-stats"},ge={key:2,class:"empty-state"},_e={key:0,class:"loading-container"},fe={key:1,class:"playlist-grid"},me=["onClick"],pe={class:"playlist-cover-wrapper"},ve={class:"playlist-overlay"},ye={class:"playlist-info"},Ce=["title"],he={class:"playlist-creator"},Pe={class:"playlist-stats"},be={key:2,class:"empty-state"};function ke(U,a,H,e,m,y){const u=r("el-radio-button"),C=r("el-radio-group"),h=r("el-tag"),v=r("Loading"),d=r("el-icon"),P=r("PlaylistCover"),b=r("CaretRight"),S=r("User"),k=r("List"),p=r("Headset"),z=r("FolderOpened"),R=r("el-button"),x=r("el-empty"),L=r("el-pagination"),V=r("el-tab-pane"),l=r("el-tabs");return c(),g("div",te,[a[16]||(a[16]=s("div",{class:"page-header"},[s("h2",null,"🎵 歌单广场"),s("p",{class:"subtitle"},"发现更多精彩歌单")],-1)),s("div",ae,[t(C,{modelValue:e.selectedCategory,"onUpdate:modelValue":a[0]||(a[0]=n=>e.selectedCategory=n),onChange:e.handleCategoryChange},{default:o(()=>[t(u,{label:""},{default:o(()=>[...a[5]||(a[5]=[i("全部",-1)])]),_:1}),t(u,{label:"流行"},{default:o(()=>[...a[6]||(a[6]=[i("流行",-1)])]),_:1}),t(u,{label:"摇滚"},{default:o(()=>[...a[7]||(a[7]=[i("摇滚",-1)])]),_:1}),t(u,{label:"民谣"},{default:o(()=>[...a[8]||(a[8]=[i("民谣",-1)])]),_:1}),t(u,{label:"电子"},{default:o(()=>[...a[9]||(a[9]=[i("电子",-1)])]),_:1}),t(u,{label:"纯音乐"},{default:o(()=>[...a[10]||(a[10]=[i("纯音乐",-1)])]),_:1}),t(u,{label:"其他"},{default:o(()=>[...a[11]||(a[11]=[i("其他",-1)])]),_:1})]),_:1},8,["modelValue","onChange"])]),t(l,{modelValue:e.activeTab,"onUpdate:modelValue":a[4]||(a[4]=n=>e.activeTab=n),onTabChange:e.handleTabChange},{default:o(()=>[t(V,{name:"recommend"},{label:o(()=>[s("span",null,[a[13]||(a[13]=i(" 推荐歌单 ",-1)),e.isLogin&&!e.selectedCategory&&e.currentPage===1?(c(),E(h,{key:0,size:"small",type:"success",style:{"margin-left":"8px"}},{default:o(()=>[...a[12]||(a[12]=[i("个性化",-1)])]),_:1})):F("",!0)])]),default:o(()=>[e.loading?(c(),g("div",le,[t(d,{class:"is-loading"},{default:o(()=>[t(v)]),_:1})])):e.playlists.length>0?(c(),g("div",oe,[(c(!0),g(B,null,D(e.playlists,n=>{var T;return c(),g("div",{key:n.id,class:"playlist-card",onClick:N=>e.goToPlaylistDetail(n.id)},[s("div",se,[t(P,{cover:n.cover,size:200,"default-cover":e.defaultCover,class:"playlist-cover"},null,8,["cover","default-cover"]),s("div",re,[t(d,{class:"play-icon"},{default:o(()=>[t(b)]),_:1})])]),s("div",ie,[s("h4",{class:"playlist-name",title:n.name},f(n.name),9,de),s("p",ce,[t(d,null,{default:o(()=>[t(S)]),_:1}),i(" "+f(((T=n.creator)==null?void 0:T.nickname)||"未知"),1)]),s("p",ue,[s("span",null,[t(d,null,{default:o(()=>[t(k)]),_:1}),i(" "+f(n.songCount||0)+" 首 ",1)]),s("span",null,[t(d,null,{default:o(()=>[t(p)]),_:1}),i(" "+f(e.formatCount(n.playCount)),1)])])])],8,ne)}),128))])):(c(),g("div",ge,[t(x,{description:"暂无歌单"},W({image:o(()=>[t(d,{style:{"font-size":"80px",color:"#ddd"}},{default:o(()=>[t(z)]),_:1})]),_:2},[e.isLogin?void 0:{name:"description",fn:o(()=>[a[15]||(a[15]=s("p",null,"暂无推荐歌单",-1)),t(R,{type:"primary",onClick:a[1]||(a[1]=n=>U.$router.push("/login"))},{default:o(()=>[...a[14]||(a[14]=[i("登录查看个性化推荐",-1)])]),_:1})]),key:"0"}]),1024)])),e.total>e.pageSize?(c(),E(L,{key:3,"current-page":e.currentPage,"onUpdate:currentPage":a[2]||(a[2]=n=>e.currentPage=n),"page-size":e.pageSize,total:e.total,layout:"prev, pager, next, total",class:"pagination",onCurrentChange:e.loadPlaylists},null,8,["current-page","page-size","total","onCurrentChange"])):F("",!0)]),_:1}),t(V,{label:"热门歌单",name:"hot"},{default:o(()=>[e.loading?(c(),g("div",_e,[t(d,{class:"is-loading"},{default:o(()=>[t(v)]),_:1})])):e.hotPlaylists.length>0?(c(),g("div",fe,[(c(!0),g(B,null,D(e.hotPlaylists,n=>{var T;return c(),g("div",{key:n.id,class:"playlist-card",onClick:N=>e.goToPlaylistDetail(n.id)},[s("div",pe,[t(P,{cover:n.cover,size:200,"default-cover":e.defaultCover,class:"playlist-cover"},null,8,["cover","default-cover"]),s("div",ve,[t(d,{class:"play-icon"},{default:o(()=>[t(b)]),_:1})])]),s("div",ye,[s("h4",{class:"playlist-name",title:n.name},f(n.name),9,Ce),s("p",he,[t(d,null,{default:o(()=>[t(S)]),_:1}),i(" "+f(((T=n.creator)==null?void 0:T.nickname)||"未知"),1)]),s("p",Pe,[s("span",null,[t(d,null,{default:o(()=>[t(k)]),_:1}),i(" "+f(n.songCount||0)+" 首 ",1)]),s("span",null,[t(d,null,{default:o(()=>[t(p)]),_:1}),i(" "+f(e.formatCount(n.playCount)),1)])])])],8,me)}),128))])):(c(),g("div",be,[t(x,{description:"暂无热门歌单"},{image:o(()=>[t(d,{style:{"font-size":"80px",color:"#ddd"}},{default:o(()=>[t(z)]),_:1})]),_:1})])),e.hotTotal>e.hotPageSize?(c(),E(L,{key:3,"current-page":e.hotCurrentPage,"onUpdate:currentPage":a[3]||(a[3]=n=>e.hotCurrentPage=n),"page-size":e.hotPageSize,total:e.hotTotal,layout:"prev, pager, next, total",class:"pagination",onCurrentChange:e.loadHotPlaylists},null,8,["current-page","page-size","total","onCurrentChange"])):F("",!0)]),_:1})]),_:1},8,["modelValue","onTabChange"])])}const Le=q(ee,[["render",ke],["__scopeId","data-v-4fc7db4c"]]);export{Le as default};
