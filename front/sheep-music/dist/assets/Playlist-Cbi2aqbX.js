import{m as a,q as e,t as l,H as t,B as s,a8 as o,r as n,c as i,d as r,al as d,F as u,A as c,D as p,G as g,Y as y,X as v}from"./vue-vendor-BzZaYQKc.js";import{P as m,g as f,a as h}from"./PlaylistCover-D3NetioR.js";import{g as C}from"./recommendation-CPTTUSqv.js";import{_,u as P}from"./index-Cb8xoRiw.js";import{Y as b,Z as k,a2 as z,a3 as T,a4 as x,L,P as j}from"./element-plus-CCPVPfgN.js";import"./request-76E38DvM.js";const w={class:"playlist-square"},S={class:"category-filter"},U={key:0,class:"loading-container"},V={key:1,class:"playlist-grid"},H=["onClick"],q={class:"playlist-cover-wrapper"},D={class:"playlist-overlay"},F={class:"playlist-info"},E=["title"],R={class:"playlist-creator"},Y={class:"playlist-stats"},$={key:2,class:"empty-state"},A={key:0,class:"loading-container"},B={key:1,class:"playlist-grid"},G=["onClick"],I={class:"playlist-cover-wrapper"},O={class:"playlist-overlay"},X={class:"playlist-info"},Z=["title"],J={class:"playlist-creator"},K={class:"playlist-stats"},M={key:2,class:"empty-state"};const N=_({name:"PlaylistSquare",components:{PlaylistCover:m,Loading:x,CaretRight:T,User:z,List:k,Headset:b},setup(){const a=d(),e=P(),l=n("recommend"),t=n(""),s=n(!1),o=n([]),u=n(1),c=n(20),p=n(0),g=n([]),y=n(1),v=n(20),m=n(0),_=i(()=>e.isLogin),b=async()=>{s.value=!0;try{let e;if(_.value&&!t.value&&1===u.value)try{if(e=await C({limit:c.value}),200===e.code&&e.data&&e.data.length>0)return o.value=e.data,p.value=e.data.length,void(s.value=!1)}catch(a){console.log("个性化推荐失败，使用默认推荐:",a)}e=await f({page:u.value-1,size:c.value,category:t.value||void 0}),200===e.code?(o.value=e.data.content||[],p.value=e.data.totalElements||0):L.warning(e.message||"加载失败")}catch(a){console.error("加载歌单失败:",a),L.error("加载歌单失败，请稍后重试")}finally{s.value=!1}},k=async()=>{s.value=!0;try{const a=await h({page:y.value-1,size:v.value});200===a.code?(g.value=a.data.content||[],m.value=a.data.totalElements||0):L.warning(a.message||"加载失败")}catch(a){console.error("加载热门歌单失败:",a),L.error("加载热门歌单失败，请稍后重试")}finally{s.value=!1}};return r(()=>{b()}),{activeTab:l,selectedCategory:t,loading:s,playlists:o,currentPage:u,pageSize:c,total:p,hotPlaylists:g,hotCurrentPage:y,hotPageSize:v,hotTotal:m,defaultCover:"https://via.placeholder.com/200?text=Playlist",isLogin:_,loadPlaylists:b,loadHotPlaylists:k,handleCategoryChange:()=>{u.value=1,"recommend"===l.value&&b()},handleTabChange:a=>{"recommend"===a?0===o.value.length&&b():"hot"===a&&0===g.value.length&&k()},goToPlaylistDetail:e=>{a.push(`/playlist/${e}`)},formatCount:a=>a?a>=1e4?(a/1e4).toFixed(1)+"万":a:0}}},[["render",function(n,i,r,d,m,f){const h=o("el-radio-button"),C=o("el-radio-group"),_=o("el-tag"),P=o("Loading"),b=o("el-icon"),k=o("PlaylistCover"),z=o("CaretRight"),T=o("User"),x=o("List"),L=o("Headset"),N=o("FolderOpened"),Q=o("el-button"),W=o("el-empty"),aa=o("el-pagination"),ea=o("el-tab-pane"),la=o("el-tabs");return e(),a("div",w,[i[16]||(i[16]=l("div",{class:"page-header"},[l("h2",null,"🎵 歌单广场"),l("p",{class:"subtitle"},"发现更多精彩歌单")],-1)),l("div",S,[t(C,{modelValue:d.selectedCategory,"onUpdate:modelValue":i[0]||(i[0]=a=>d.selectedCategory=a),onChange:d.handleCategoryChange},{default:s(()=>[t(h,{label:""},{default:s(()=>[...i[5]||(i[5]=[u("全部",-1)])]),_:1}),t(h,{label:"流行"},{default:s(()=>[...i[6]||(i[6]=[u("流行",-1)])]),_:1}),t(h,{label:"摇滚"},{default:s(()=>[...i[7]||(i[7]=[u("摇滚",-1)])]),_:1}),t(h,{label:"民谣"},{default:s(()=>[...i[8]||(i[8]=[u("民谣",-1)])]),_:1}),t(h,{label:"电子"},{default:s(()=>[...i[9]||(i[9]=[u("电子",-1)])]),_:1}),t(h,{label:"纯音乐"},{default:s(()=>[...i[10]||(i[10]=[u("纯音乐",-1)])]),_:1}),t(h,{label:"其他"},{default:s(()=>[...i[11]||(i[11]=[u("其他",-1)])]),_:1})]),_:1},8,["modelValue","onChange"])]),t(la,{modelValue:d.activeTab,"onUpdate:modelValue":i[4]||(i[4]=a=>d.activeTab=a),onTabChange:d.handleTabChange},{default:s(()=>[t(ea,{name:"recommend"},{label:s(()=>[l("span",null,[i[13]||(i[13]=u(" 推荐歌单 ",-1)),d.isLogin&&!d.selectedCategory&&1===d.currentPage?(e(),c(_,{key:0,size:"small",type:"success",style:{"margin-left":"8px"}},{default:s(()=>[...i[12]||(i[12]=[u("个性化",-1)])]),_:1})):p("",!0)])]),default:s(()=>[d.loading?(e(),a("div",U,[t(b,{class:"is-loading"},{default:s(()=>[t(P)]),_:1})])):d.playlists.length>0?(e(),a("div",V,[(e(!0),a(g,null,y(d.playlists,o=>{var n;return e(),a("div",{key:o.id,class:"playlist-card",onClick:a=>d.goToPlaylistDetail(o.id)},[l("div",q,[t(k,{cover:o.cover,size:200,"default-cover":d.defaultCover,class:"playlist-cover"},null,8,["cover","default-cover"]),l("div",D,[t(b,{class:"play-icon"},{default:s(()=>[t(z)]),_:1})])]),l("div",F,[l("h4",{class:"playlist-name",title:o.name},j(o.name),9,E),l("p",R,[t(b,null,{default:s(()=>[t(T)]),_:1}),u(" "+j((null==(n=o.creator)?void 0:n.nickname)||"未知"),1)]),l("p",Y,[l("span",null,[t(b,null,{default:s(()=>[t(x)]),_:1}),u(" "+j(o.songCount||0)+" 首 ",1)]),l("span",null,[t(b,null,{default:s(()=>[t(L)]),_:1}),u(" "+j(d.formatCount(o.playCount)),1)])])])],8,H)}),128))])):(e(),a("div",$,[t(W,{description:"暂无歌单"},v({image:s(()=>[t(b,{style:{"font-size":"80px",color:"#ddd"}},{default:s(()=>[t(N)]),_:1})]),_:2},[d.isLogin?void 0:{name:"description",fn:s(()=>[i[15]||(i[15]=l("p",null,"暂无推荐歌单",-1)),t(Q,{type:"primary",onClick:i[1]||(i[1]=a=>n.$router.push("/login"))},{default:s(()=>[...i[14]||(i[14]=[u("登录查看个性化推荐",-1)])]),_:1})]),key:"0"}]),1024)])),d.total>d.pageSize?(e(),c(aa,{key:3,"current-page":d.currentPage,"onUpdate:currentPage":i[2]||(i[2]=a=>d.currentPage=a),"page-size":d.pageSize,total:d.total,layout:"prev, pager, next, total",class:"pagination",onCurrentChange:d.loadPlaylists},null,8,["current-page","page-size","total","onCurrentChange"])):p("",!0)]),_:1}),t(ea,{label:"热门歌单",name:"hot"},{default:s(()=>[d.loading?(e(),a("div",A,[t(b,{class:"is-loading"},{default:s(()=>[t(P)]),_:1})])):d.hotPlaylists.length>0?(e(),a("div",B,[(e(!0),a(g,null,y(d.hotPlaylists,o=>{var n;return e(),a("div",{key:o.id,class:"playlist-card",onClick:a=>d.goToPlaylistDetail(o.id)},[l("div",I,[t(k,{cover:o.cover,size:200,"default-cover":d.defaultCover,class:"playlist-cover"},null,8,["cover","default-cover"]),l("div",O,[t(b,{class:"play-icon"},{default:s(()=>[t(z)]),_:1})])]),l("div",X,[l("h4",{class:"playlist-name",title:o.name},j(o.name),9,Z),l("p",J,[t(b,null,{default:s(()=>[t(T)]),_:1}),u(" "+j((null==(n=o.creator)?void 0:n.nickname)||"未知"),1)]),l("p",K,[l("span",null,[t(b,null,{default:s(()=>[t(x)]),_:1}),u(" "+j(o.songCount||0)+" 首 ",1)]),l("span",null,[t(b,null,{default:s(()=>[t(L)]),_:1}),u(" "+j(d.formatCount(o.playCount)),1)])])])],8,G)}),128))])):(e(),a("div",M,[t(W,{description:"暂无热门歌单"},{image:s(()=>[t(b,{style:{"font-size":"80px",color:"#ddd"}},{default:s(()=>[t(N)]),_:1})]),_:1})])),d.hotTotal>d.hotPageSize?(e(),c(aa,{key:3,"current-page":d.hotCurrentPage,"onUpdate:currentPage":i[3]||(i[3]=a=>d.hotCurrentPage=a),"page-size":d.hotPageSize,total:d.hotTotal,layout:"prev, pager, next, total",class:"pagination",onCurrentChange:d.loadHotPlaylists},null,8,["current-page","page-size","total","onCurrentChange"])):p("",!0)]),_:1})]),_:1},8,["modelValue","onTabChange"])])}],["__scopeId","data-v-4fc7db4c"]]);export{N as default};
