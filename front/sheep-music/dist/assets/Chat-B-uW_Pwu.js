const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CxmcMKp9.js","assets/index-DT83KSMX.css"])))=>i.map(i=>d[i]);
import{_ as pe,v as Me,x as Q,g as w,y as he,B as H,o as i,w as n,a as o,d as a,r as h,c as d,Q as m,aw as ve,t as k,e as B,O as X,P as ye,k as L,F as Y,l as ee,Z as Ue,E as $,D as ne,f as Le,ao as Be,i as Oe,L as je,ax as oe,ay as W,az as Fe,j as Ee,s as Je,aA as Ke,u as He,aB as xe,aC as Te,aD as Ge,ae as Qe,n as _e,G as le,aE as fe,aF as Ze,a5 as qe,aG as We}from"./index-CxmcMKp9.js";import{j as Xe}from"./playlist-D_Dp_PwR.js";const Ye={class:"song-selector"},et={class:"search-box"},tt={key:0,class:"current-song"},at={class:"image-error"},st={class:"song-info"},rt={class:"song-name"},ot={class:"song-artist"},lt={key:1,class:"empty-state"},nt={class:"song-list"},it={key:0,class:"empty-state"},ct=["onClick"],dt={class:"image-error"},ut={class:"song-info"},vt={class:"song-name"},_t={class:"song-artist"},ft={class:"song-list"},pt={key:0,class:"empty-state"},ht=["onClick"],yt={class:"image-error"},mt={class:"song-info"},wt={class:"song-name"},Ct={class:"song-artist"},St={__name:"SongSelector",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(te,{emit:K}){const G=te,N=K,M=Me(),A=Q({get:()=>G.modelValue,set:c=>N("update:modelValue",c)}),x=w("current"),S=w(""),D=w(!1),T=w([]);let z=null;const p=Q(()=>{const c=M.currentSong;if(!c)return null;let l="未知歌手";return c.artist?l=Array.isArray(c.artist)?c.artist.join(", "):c.artist:c.artists?l=Array.isArray(c.artists)?c.artists.join(", "):c.artists:c.artistName&&(l=c.artistName),{...c,cover:c.cover||c.avatar||c.picUrl||"",artist:l}}),P=Q(()=>(M.playlist||[]).map(l=>{let R="未知歌手";return l.artist?R=Array.isArray(l.artist)?l.artist.join(", "):l.artist:l.artists?R=Array.isArray(l.artists)?l.artists.join(", "):l.artists:l.artistName&&(R=l.artistName),{...l,cover:l.cover||l.avatar||l.picUrl||"",artist:R}})),I=c=>{c==="search"&&S.value&&b()},_=()=>{if(x.value!=="search"&&(x.value="search"),z&&clearTimeout(z),!S.value.trim()){T.value=[];return}z=setTimeout(()=>{b()},500)},b=async()=>{var c;if(!S.value.trim()){T.value=[];return}D.value=!0;try{const l=await Ue({keyword:S.value,page:0,size:20});if(l.code===200){const O=(((c=l.data)==null?void 0:c.content)||[]).map(f=>{let v="未知歌手";f.artist?Array.isArray(f.artist)?v=f.artist.map(y=>typeof y=="object"&&y!==null&&(y.name||y.artistName)||String(y)).join(", "):v=f.artist:f.artists?Array.isArray(f.artists)?v=f.artists.map(y=>typeof y=="object"&&y!==null&&(y.name||y.artistName)||String(y)).join(", "):v=f.artists:f.artistName&&(v=f.artistName);const J=f.name||f.songName||f.title||"未知歌曲";return{id:f.id,name:J,cover:f.cover||f.avatar||f.picUrl||"",artist:v}});T.value=O}}catch(l){console.error("搜索歌曲失败:",l),$.error("搜索失败")}finally{D.value=!1}},F=c=>{c&&(N("select",c),A.value=!1)},E=()=>{S.value="",T.value=[],x.value="current"};return he(A,c=>{c||E()}),(c,l)=>{const R=h("el-input"),O=h("el-icon"),f=h("el-image"),v=h("el-button"),J=h("el-empty"),y=h("el-tab-pane"),ae=h("el-tabs"),ie=h("el-dialog"),Z=ye("loading");return i(),H(ie,{modelValue:A.value,"onUpdate:modelValue":l[3]||(l[3]=C=>A.value=C),title:"选择歌曲",width:"600px",onClose:E},{default:n(()=>[o("div",Ye,[o("div",et,[a(R,{modelValue:S.value,"onUpdate:modelValue":l[0]||(l[0]=C=>S.value=C),placeholder:"搜索歌曲名称或歌手","prefix-icon":"Search",clearable:"",onInput:_},null,8,["modelValue"])]),a(ae,{modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=C=>x.value=C),onTabChange:I},{default:n(()=>[a(y,{label:"当前播放",name:"current"},{default:n(()=>[p.value?(i(),d("div",tt,[o("div",{class:"song-item",onClick:l[1]||(l[1]=C=>F(p.value))},[a(f,{src:p.value.cover,fit:"cover",class:"song-cover"},{error:n(()=>[o("div",at,[a(O,null,{default:n(()=>[a(m(ve))]),_:1})])]),_:1},8,["src"]),o("div",st,[o("div",rt,k(p.value.name),1),o("div",ot,k(p.value.artist),1)]),a(v,{type:"primary",size:"small"},{default:n(()=>[...l[4]||(l[4]=[B("选择",-1)])]),_:1})])])):(i(),d("div",lt,[a(J,{description:"当前没有播放歌曲"})]))]),_:1}),a(y,{label:"播放列表",name:"playlist"},{default:n(()=>[X((i(),d("div",nt,[P.value.length===0&&!D.value?(i(),d("div",it,[a(J,{description:"播放列表为空"})])):L("",!0),(i(!0),d(Y,null,ee(P.value,C=>(i(),d("div",{key:C.id,class:"song-item",onClick:ce=>F(C)},[a(f,{src:C.cover,fit:"cover",class:"song-cover"},{error:n(()=>[o("div",dt,[a(O,null,{default:n(()=>[a(m(ve))]),_:1})])]),_:1},8,["src"]),o("div",ut,[o("div",vt,k(C.name),1),o("div",_t,k(C.artist),1)]),a(v,{type:"primary",size:"small"},{default:n(()=>[...l[5]||(l[5]=[B("选择",-1)])]),_:1})],8,ct))),128))])),[[Z,D.value]])]),_:1}),a(y,{label:"搜索",name:"search"},{default:n(()=>[X((i(),d("div",ft,[T.value.length===0&&!D.value?(i(),d("div",pt,[a(J,{description:S.value?"没有找到相关歌曲":"请输入关键词搜索"},null,8,["description"])])):L("",!0),(i(!0),d(Y,null,ee(T.value,C=>(i(),d("div",{key:C.id,class:"song-item",onClick:ce=>F(C)},[a(f,{src:C.cover,fit:"cover",class:"song-cover"},{error:n(()=>[o("div",yt,[a(O,null,{default:n(()=>[a(m(ve))]),_:1})])]),_:1},8,["src"]),o("div",mt,[o("div",wt,k(C.name),1),o("div",Ct,k(C.artist),1)]),a(v,{type:"primary",size:"small"},{default:n(()=>[...l[6]||(l[6]=[B("选择",-1)])]),_:1})],8,ht))),128))])),[[Z,D.value]])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}},kt=pe(St,[["__scopeId","data-v-9d690710"]]),It={class:"playlist-selector"},bt={class:"search-box"},$t={class:"playlist-list"},Dt={key:0,class:"empty-state"},gt=["onClick"],Vt={class:"image-error"},Nt={class:"playlist-info"},xt={class:"playlist-name"},Tt={class:"playlist-desc"},Mt={key:0},At={__name:"PlaylistShareSelector",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(te,{emit:K}){const G=te,N=K,M=Q({get:()=>G.modelValue,set:_=>N("update:modelValue",_)}),A=w(!1),x=w([]),S=w(""),D=Q(()=>{if(!S.value)return x.value;const _=S.value.toLowerCase();return x.value.filter(b=>b.name.toLowerCase().includes(_))}),T=_=>_>=1e4?(_/1e4).toFixed(1)+"万":_,z=async()=>{A.value=!0;try{const _=await Xe();_.code===200&&(x.value=_.data||[])}catch(_){console.error("加载歌单失败:",_),$.error("加载歌单失败")}finally{A.value=!1}},p=_=>{_&&(N("select",_),M.value=!1)},P=()=>{$.info('请先在"我的歌单"页面创建歌单'),M.value=!1},I=()=>{S.value=""};return he(M,_=>{_?z():I()}),(_,b)=>{const F=h("el-input"),E=h("el-button"),c=h("el-empty"),l=h("el-icon"),R=h("el-image"),O=h("el-dialog"),f=ye("loading");return i(),H(O,{modelValue:M.value,"onUpdate:modelValue":b[1]||(b[1]=v=>M.value=v),title:"选择歌单",width:"600px",onClose:I},{default:n(()=>[o("div",It,[o("div",bt,[a(F,{modelValue:S.value,"onUpdate:modelValue":b[0]||(b[0]=v=>S.value=v),placeholder:"搜索歌单名称","prefix-icon":"Search",clearable:""},null,8,["modelValue"])]),X((i(),d("div",$t,[D.value.length===0&&!A.value?(i(),d("div",Dt,[a(c,{description:"还没有歌单"},{default:n(()=>[a(E,{type:"primary",onClick:P},{default:n(()=>[...b[2]||(b[2]=[B("创建第一个歌单",-1)])]),_:1})]),_:1})])):L("",!0),(i(!0),d(Y,null,ee(D.value,v=>(i(),d("div",{key:v.id,class:"playlist-item",onClick:J=>p(v)},[a(R,{src:v.cover,fit:"cover",class:"playlist-cover"},{error:n(()=>[o("div",Vt,[a(l,null,{default:n(()=>[a(m(ne))]),_:1})])]),_:1},8,["src"]),o("div",Nt,[o("div",xt,k(v.name),1),o("div",Tt,[o("span",null,k(v.songCount||0)+" 首歌曲",1),v.playCount?(i(),d("span",Mt," · "+k(T(v.playCount))+" 次播放",1)):L("",!0)])]),a(E,{type:"primary",size:"small"},{default:n(()=>[...b[3]||(b[3]=[B("选择",-1)])]),_:1})],8,gt))),128))])),[[f,A.value]])])]),_:1},8,["modelValue"])}}},Rt=pe(At,[["__scopeId","data-v-9c08eef6"]]),zt={class:"chat-page"},Pt={class:"conversation-list"},Ut={class:"list-header"},Lt={class:"search-box"},Bt={class:"conversations"},Ot={key:0,class:"empty-state"},jt=["onClick"],Ft={class:"conv-info"},Et={class:"conv-name"},Jt={class:"conv-message"},Kt={class:"conv-time"},Ht={class:"chat-window"},Gt={key:0,class:"chat-container"},Qt={class:"chat-header"},Zt={class:"header-info"},qt={class:"friend-name"},Wt={key:0,class:"empty-messages"},Xt={class:"message-content"},Yt={key:0,class:"message-text"},ea=["onClick"],ta={class:"share-cover-error"},aa={key:1,class:"share-cover-error"},sa={class:"share-content"},ra={class:"share-title"},oa={class:"share-subtitle"},la=["onClick"],na={class:"share-cover-error"},ia={key:1,class:"share-cover-error"},ca={class:"share-content"},da={class:"share-title"},ua={class:"share-subtitle"},va={key:3,class:"message-recalled"},_a={class:"message-time"},fa={class:"chat-input"},pa={class:"input-actions"},ha={key:1,class:"empty-chat"},ya={__name:"Chat",setup(te){const K=je(),G=He(),N=Le(),M=Be(),A=Me(),x=w(!1),S=w(!1),D=w(!1),T=w(""),z=w([]),p=w(null),P=w(null),I=w([]),_=w(""),b=w(null),F=w(0),E=w(!0),c=w(!1),l=w(!1),R=Q(()=>{if(!T.value)return z.value;const e=T.value.toLowerCase();return z.value.filter(t=>t.friendName.toLowerCase().includes(e))}),O=e=>{if(!e)return"";const t=new Date(e),u=new Date-t,g=Math.floor(u/(1e3*60*60*24));return g===0?t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):g===1?"昨天":g<7?`${g}天前`:t.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},f=e=>e?new Date(e).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):"",v=async()=>{x.value=!0;try{const e=await Ke();e.code===200&&(z.value=e.data||[])}catch(e){console.error("加载会话列表失败:",e)}finally{x.value=!1}},J=()=>{v(),M.loadConversations()},y=async e=>{p.value=e.friendId,G.push(`/chat/${e.friendId}`);try{const t=await xe();if(t.code===200){const s=t.data.find(u=>u.friendId===e.friendId);s&&(P.value=s.friend||{id:e.friendId,nickname:e.friendName,avatar:e.friendAvatar})}}catch(t){console.error("加载好友信息失败:",t)}await ae(e.friendId);try{await Te(e.friendId),await M.updateUnreadMessageCount(),await v()}catch(t){console.error("标记已读失败:",t)}},ae=async(e,t=!0)=>{t&&(F.value=0,I.value=[],E.value=!0),S.value=!0;try{const s=await Ge(e,{page:F.value,size:50});if(s.code===200){const u=s.data,g=(u.content||[]).map(V=>{if((V.type==="song"||V.type==="playlist")&&V.content&&!V.shareData)try{V.shareData=JSON.parse(V.content)}catch(j){console.error("解析分享数据失败:",j)}return V});t?I.value=g.reverse():I.value=[...g.reverse(),...I.value],E.value=!u.first,await W(),q()}}catch(s){console.error("加载聊天记录失败:",s)}finally{S.value=!1}},ie=async e=>{if(!(!e||!e.id)){try{await qe.confirm("确定撤回这条消息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch{return}try{(await We(e.id)).code===200&&(e.isRecalled=!0,e.type==="text"&&(e.content=""),$.success("已撤回"))}catch(t){console.error("撤回消息失败:",t),$.error("撤回失败")}}},Z=async()=>{var e;if(!(!_.value.trim()||!p.value)){D.value=!0;try{const t={receiverId:p.value,type:"text",content:_.value.trim()};oe.sendChatMessage(t);const s=`tmp-${Date.now()}`;I.value.push({clientId:s,local:!0,senderId:(e=N.userInfo)==null?void 0:e.id,receiverId:p.value,type:"text",content:t.content,createTime:new Date().toISOString(),isRecalled:!1}),_.value="",await W(),q(),await v()}catch(t){console.error("发送消息失败:",t)}finally{D.value=!1}}},C=()=>{if(!p.value){$.warning("请先选择聊天对象");return}c.value=!0},ce=()=>{if(!p.value){$.warning("请先选择聊天对象");return}l.value=!0},Ae=async e=>{var t;if(!(!e||!p.value)){D.value=!0;try{const s={receiverId:p.value,type:"song",content:JSON.stringify({id:e.id,name:e.name,artist:e.artist,cover:e.cover})};oe.sendChatMessage(s);const u=`tmp-${Date.now()}`;I.value.push({clientId:u,local:!0,senderId:(t=N.userInfo)==null?void 0:t.id,receiverId:p.value,type:"song",content:s.content,shareData:{id:e.id,name:e.name,artist:e.artist,cover:e.cover},createTime:new Date().toISOString(),isRecalled:!1}),await W(),q(),await v(),$.success("分享成功")}catch(s){console.error("分享歌曲失败:",s),$.error("分享失败")}finally{D.value=!1}}},Re=async e=>{var t;if(!(!e||!p.value)){D.value=!0;try{const s={receiverId:p.value,type:"playlist",content:JSON.stringify({id:e.id,name:e.name,cover:e.cover,songCount:e.songCount})};oe.sendChatMessage(s);const u=`tmp-${Date.now()}`;I.value.push({clientId:u,local:!0,senderId:(t=N.userInfo)==null?void 0:t.id,receiverId:p.value,type:"playlist",content:s.content,shareData:{id:e.id,name:e.name,cover:e.cover,songCount:e.songCount},createTime:new Date().toISOString(),isRecalled:!1}),await W(),q(),await v(),$.success("分享成功")}catch(s){console.error("分享歌单失败:",s),$.error("分享失败")}finally{D.value=!1}}},ze=async e=>{var t;if(!e.shareData&&e.content)try{e.shareData=JSON.parse(e.content)}catch(s){console.error("解析歌曲数据失败:",s),$.error("歌曲数据解析失败");return}if(console.log("点击分享的歌曲:",e.shareData),!((t=e.shareData)!=null&&t.id)){$.warning("歌曲信息不完整");return}try{if(e.shareData.url)A.play(e.shareData),$.success("开始播放");else{$.info("正在加载歌曲...");const{getMusicDetail:s}=await Ze(async()=>{const{getMusicDetail:g}=await import("./index-CxmcMKp9.js").then(V=>V.ig);return{getMusicDetail:g}},__vite__mapDeps([0,1])),u=await s(e.shareData.id);if(u.code===200&&u.data){const g={...e.shareData,...u.data};A.play(g),$.success("开始播放")}else $.error("获取歌曲信息失败")}}catch(s){console.error("播放歌曲失败:",s),$.error("播放失败")}},Pe=e=>{var t;if(!e.shareData&&e.content)try{e.shareData=JSON.parse(e.content)}catch(s){console.error("解析歌单数据失败:",s)}(t=e.shareData)!=null&&t.id&&G.push(`/playlist/${e.shareData.id}`)},q=()=>{b.value&&(b.value.scrollTop=b.value.scrollHeight)};return he(()=>K.params.friendId,async e=>{if(e){p.value=Number(e);const t=z.value.find(s=>s.friendId===Number(e));if(t)await y(t);else{try{const s=await xe();if(s.code===200){const u=s.data.find(g=>g.friendId===Number(e));u&&(P.value=u.friend||{id:Number(e),nickname:u.friendName,avatar:u.friendAvatar})}}catch{}await ae(Number(e));try{await Te(Number(e)),await M.updateUnreadMessageCount()}catch{}await v()}}},{immediate:!0}),Oe(async()=>{if(await v(),K.params.friendId){const t=Number(K.params.friendId),s=z.value.find(u=>u.friendId===t);s&&await y(s)}const e=oe.onChatMessage(async t=>{var s;try{if(!t||!p.value)return;const u=p.value;if(t.senderId===u||t.receiverId===u){if((t.type==="song"||t.type==="playlist")&&t.content&&!t.shareData)try{t.shareData=JSON.parse(t.content)}catch(V){console.error("解析分享数据失败:",V)}if(t.senderId===((s=N.userInfo)==null?void 0:s.id)){const V=(U,se)=>{const de=new Date(U).getTime(),re=new Date(se).getTime();return Math.abs(de-re)<1e4},j=I.value.findIndex(U=>U.local===!0&&U.senderId===t.senderId&&U.receiverId===t.receiverId&&U.type===t.type&&U.content===t.content&&U.createTime&&t.createTime&&V(U.createTime,t.createTime));j!==-1?I.value[j]={...t}:I.value.push(t)}else I.value.push(t);await W(),q()}}catch{}});Fe(()=>{typeof e=="function"&&e()})}),(e,t)=>{const s=h("el-icon"),u=h("el-button"),g=h("el-input"),V=h("el-empty"),j=h("el-avatar"),U=h("el-badge"),se=h("el-image"),de=h("el-button-group"),re=ye("loading");return i(),d("div",zt,[o("div",Pt,[o("div",Ut,[t[4]||(t[4]=o("h3",null,"聊天",-1)),a(u,{text:"",onClick:J},{default:n(()=>[a(s,null,{default:n(()=>[a(m(Qe))]),_:1})]),_:1})]),o("div",Lt,[a(g,{modelValue:T.value,"onUpdate:modelValue":t[0]||(t[0]=r=>T.value=r),placeholder:"搜索好友","prefix-icon":"Search",clearable:""},null,8,["modelValue"])]),X((i(),d("div",Bt,[R.value.length===0&&!x.value?(i(),d("div",Ot,[a(V,{description:"暂无会话"})])):L("",!0),(i(!0),d(Y,null,ee(R.value,r=>(i(),d("div",{key:r.id,class:_e(["conversation-item",{active:p.value===r.friendId}]),onClick:ue=>y(r)},[a(U,{value:r.unreadCount,hidden:!r.unreadCount},{default:n(()=>[a(j,{src:r.friendAvatar,size:45},{default:n(()=>[a(s,null,{default:n(()=>[a(m(le))]),_:1})]),_:1},8,["src"])]),_:2},1032,["value","hidden"]),o("div",Ft,[o("div",Et,k(r.friendName),1),o("div",Jt,k(r.lastMessage||"暂无消息"),1)]),o("div",Kt,k(O(r.lastMessageTime)),1)],10,jt))),128))])),[[re,x.value]])]),o("div",Ht,[P.value?(i(),d("div",Gt,[o("div",Qt,[a(j,{src:P.value.avatar,size:40},{default:n(()=>[a(s,null,{default:n(()=>[a(m(le))]),_:1})]),_:1},8,["src"]),o("div",Zt,[o("div",qt,k(P.value.nickname||P.value.username),1),t[5]||(t[5]=o("div",{class:"friend-status"},"在线",-1))])]),X((i(),d("div",{ref_key:"messageListRef",ref:b,class:"message-list"},[I.value.length===0&&!S.value?(i(),d("div",Wt,[a(V,{description:"开始聊天吧~"})])):L("",!0),(i(!0),d(Y,null,ee(I.value,r=>{var ue,me,we,Ce,Se,ke,Ie,be,$e,De,ge,Ve;return i(),d("div",{key:r.id||r.clientId,class:_e(["message-item",{"is-self":r.senderId===((ue=m(N).userInfo)==null?void 0:ue.id)}])},[r.senderId!==((me=m(N).userInfo)==null?void 0:me.id)?(i(),H(j,{key:0,src:r.senderAvatar,size:35},{default:n(()=>[a(s,null,{default:n(()=>[a(m(le))]),_:1})]),_:1},8,["src"])):L("",!0),o("div",Xt,[o("div",{class:_e(["message-bubble",{"is-self":r.senderId===((we=m(N).userInfo)==null?void 0:we.id)}])},[r.type==="text"&&!r.isRecalled?(i(),d("div",Yt,k(r.content),1)):r.type==="song"&&!r.isRecalled?(i(),d("div",{key:1,class:"message-share",onClick:Ne=>ze(r)},[(Ce=r.shareData)!=null&&Ce.cover?(i(),H(se,{key:0,src:r.shareData.cover,fit:"cover",class:"share-cover"},{error:n(()=>[o("div",ta,[a(s,null,{default:n(()=>[a(m(fe))]),_:1})])]),_:1},8,["src"])):(i(),d("div",aa,[a(s,null,{default:n(()=>[a(m(fe))]),_:1})])),o("div",sa,[o("div",ra,k(((Se=r.shareData)==null?void 0:Se.name)||"歌曲"),1),o("div",oa,k(((ke=r.shareData)==null?void 0:ke.artist)||""),1)])],8,ea)):r.type==="playlist"&&!r.isRecalled?(i(),d("div",{key:2,class:"message-share",onClick:Ne=>Pe(r)},[(Ie=r.shareData)!=null&&Ie.cover?(i(),H(se,{key:0,src:r.shareData.cover,fit:"cover",class:"share-cover"},{error:n(()=>[o("div",na,[a(s,null,{default:n(()=>[a(m(ne))]),_:1})])]),_:1},8,["src"])):(i(),d("div",ia,[a(s,null,{default:n(()=>[a(m(ne))]),_:1})])),o("div",ca,[o("div",da,k(((be=r.shareData)==null?void 0:be.name)||"歌单"),1),o("div",ua,k((($e=r.shareData)==null?void 0:$e.songCount)||0)+" 首歌曲",1)])],8,la)):L("",!0),r.isRecalled?(i(),d("div",va," [消息已撤回] ")):L("",!0)],2),o("div",_a,[B(k(f(r.createTime))+" ",1),r.senderId===((De=m(N).userInfo)==null?void 0:De.id)&&!r.isRecalled&&r.id?(i(),H(u,{key:0,text:"",size:"small",class:"recall-btn",onClick:Ne=>ie(r)},{default:n(()=>[...t[6]||(t[6]=[B("撤回",-1)])]),_:1},8,["onClick"])):L("",!0)])]),r.senderId===((ge=m(N).userInfo)==null?void 0:ge.id)?(i(),H(j,{key:1,src:(Ve=m(N).userInfo)==null?void 0:Ve.avatar,size:35},{default:n(()=>[a(s,null,{default:n(()=>[a(m(le))]),_:1})]),_:1},8,["src"])):L("",!0)],2)}),128))])),[[re,S.value]]),o("div",fa,[a(g,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=r=>_.value=r),type:"textarea",rows:3,placeholder:"输入消息...",maxlength:"2000","show-word-limit":"",resize:"none",onKeyup:Ee(Je(Z,["ctrl"]),["enter"])},null,8,["modelValue","onKeyup"]),o("div",pa,[a(de,null,{default:n(()=>[a(u,{text:"",onClick:C},{default:n(()=>[a(s,null,{default:n(()=>[a(m(fe))]),_:1}),t[7]||(t[7]=B(" 分享歌曲 ",-1))]),_:1}),a(u,{text:"",onClick:ce},{default:n(()=>[a(s,null,{default:n(()=>[a(m(ne))]),_:1}),t[8]||(t[8]=B(" 分享歌单 ",-1))]),_:1})]),_:1}),a(u,{type:"primary",onClick:Z,loading:D.value,disabled:!_.value.trim()},{default:n(()=>[...t[9]||(t[9]=[B(" 发送 ",-1)])]),_:1},8,["loading","disabled"])])])])):(i(),d("div",ha,[a(V,{description:"选择一个好友开始聊天"})]))]),a(kt,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=r=>c.value=r),onSelect:Ae},null,8,["modelValue"]),a(Rt,{modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=r=>l.value=r),onSelect:Re},null,8,["modelValue"])])}}},Ca=pe(ya,[["__scopeId","data-v-bcaf81db"]]);export{Ca as default};
