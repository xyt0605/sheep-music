import{m as e,q as r,t as s,H as a,B as l,a8 as o,r as i,h as t,al as m,F as n}from"./vue-vendor-BzZaYQKc.js";import{r as d}from"./user-v6clTCfC.js";import{_ as u}from"./index-Cb8xoRiw.js";import{L as g,P as p}from"./element-plus-CCPVPfgN.js";import"./request-76E38DvM.js";const c={class:"register-container"},f={class:"register-box"},w={class:"login-link"};const F=u({name:"Register",setup(){const e=m(),r=i(null),s=i(!1),a=t({username:"",password:"",confirmPassword:"",nickname:"",email:""});return{registerFormRef:r,registerForm:a,registerRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度为3-20个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度为6-20个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,r,s)=>{""===r?s(new Error("请再次输入密码")):r!==a.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}],email:[{validator:(e,r,s)=>{if(""===r)s();else{/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?s():s(new Error("请输入正确的邮箱格式"))}},trigger:"blur"}]},loading:s,handleRegister:async()=>{r.value&&await r.value.validate(async r=>{if(r)try{s.value=!0,await d({username:a.username,password:a.password,nickname:a.nickname||a.username,email:a.email}),g.success("注册成功，请登录"),setTimeout(()=>{e.push("/login")},1e3)}catch(l){g.error(l.message||"注册失败")}finally{s.value=!1}})}}}},[["render",function(i,t,m,d,u,g){const F=o("el-input"),V=o("el-form-item"),h=o("el-button"),v=o("router-link"),_=o("el-form");return r(),e("div",c,[s("div",f,[t[7]||(t[7]=s("h2",{class:"title"},"Sheep Music",-1)),t[8]||(t[8]=s("p",{class:"subtitle"},"创建新账号",-1)),a(_,{ref:"registerFormRef",model:d.registerForm,rules:d.registerRules,class:"register-form"},{default:l(()=>[a(V,{prop:"username"},{default:l(()=>[a(F,{modelValue:d.registerForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>d.registerForm.username=e),placeholder:"请输入用户名（3-20个字符）","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),a(V,{prop:"password"},{default:l(()=>[a(F,{modelValue:d.registerForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>d.registerForm.password=e),type:"password",placeholder:"请输入密码（6-20个字符）","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),a(V,{prop:"confirmPassword"},{default:l(()=>[a(F,{modelValue:d.registerForm.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>d.registerForm.confirmPassword=e),type:"password",placeholder:"请再次输入密码","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),a(V,{prop:"nickname"},{default:l(()=>[a(F,{modelValue:d.registerForm.nickname,"onUpdate:modelValue":t[3]||(t[3]=e=>d.registerForm.nickname=e),placeholder:"请输入昵称（可选）","prefix-icon":"Avatar",size:"large"},null,8,["modelValue"])]),_:1}),a(V,{prop:"email"},{default:l(()=>[a(F,{modelValue:d.registerForm.email,"onUpdate:modelValue":t[4]||(t[4]=e=>d.registerForm.email=e),placeholder:"请输入邮箱（可选）","prefix-icon":"Message",size:"large"},null,8,["modelValue"])]),_:1}),a(V,null,{default:l(()=>[a(h,{type:"primary",size:"large",loading:d.loading,onClick:d.handleRegister,class:"register-button"},{default:l(()=>[n(p(d.loading?"注册中...":"注册"),1)]),_:1},8,["loading","onClick"])]),_:1}),s("div",w,[t[6]||(t[6]=n(" 已有账号？ ",-1)),a(v,{to:"/login"},{default:l(()=>[...t[5]||(t[5]=[n("立即登录",-1)])]),_:1})])]),_:1},8,["model","rules"])])])}],["__scopeId","data-v-66e24095"]]);export{F as default};
