const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-nrl4pEAu.js","assets/index-DKgbgl8J.css"])))=>i.map(i=>d[i]);
import{_ as he,q as Te,v as X,h as w,x as pe,r as m,a4 as me,z as W,o as i,w as l,a as o,d as s,c as u,m as C,av as ve,t as $,e as j,A as te,k as O,F as ae,D as se,ac as Pe,E as D,W as ie,g as Le,j as Oe,a1 as je,aw as Z,N as Be,ar as Fe,X as le,f as Je,H as Ee,ax as fe,u as Ke,n as _e,ay as He,O as We}from"./index-nrl4pEAu.js";import{u as qe,m as xe,g as Xe,e as Ge,f as Qe,h as Ye}from"./social-B1twfuWv.js";import{j as Ze}from"./playlist-DxnxwXFm.js";import{w as ee}from"./client-DaBP6wZm.js";const et={class:"song-selector"},tt={class:"search-box"},at={key:0,class:"current-song"},st={class:"image-error"},rt={class:"song-info"},ot={class:"song-name"},nt={class:"song-artist"},lt={key:1,class:"empty-state"},it={class:"song-list"},ct={key:0,class:"empty-state"},dt=["onClick"],ut={class:"image-error"},vt={class:"song-info"},ft={class:"song-name"},_t={class:"song-artist"},ht={class:"song-list"},pt={key:0,class:"empty-state"},mt=["onClick"],yt={class:"image-error"},Ct={class:"song-info"},wt={class:"song-name"},St={class:"song-artist"},kt={__name:"SongSelector",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(re,{emit:F}){const q=re,V=F,R=Te(),z=X({get:()=>q.modelValue,set:c=>V("update:modelValue",c)}),M=w("current"),S=w(""),b=w(!1),A=w([]);let P=null;const h=X(()=>{const c=R.currentSong;if(!c)return null;let n="未知歌手";return c.artist?n=Array.isArray(c.artist)?c.artist.join(", "):c.artist:c.artists?n=Array.isArray(c.artists)?c.artists.join(", "):c.artists:c.artistName&&(n=c.artistName),{...c,cover:c.cover||c.avatar||c.picUrl||"",artist:n}}),N=X(()=>(R.playlist||[]).map(n=>{let U="未知歌手";return n.artist?U=Array.isArray(n.artist)?n.artist.join(", "):n.artist:n.artists?U=Array.isArray(n.artists)?n.artists.join(", "):n.artists:n.artistName&&(U=n.artistName),{...n,cover:n.cover||n.avatar||n.picUrl||"",artist:U}})),k=c=>{c==="search"&&S.value&&g()},v=()=>{if(M.value!=="search"&&(M.value="search"),P&&clearTimeout(P),!S.value.trim()){A.value=[];return}P=setTimeout(()=>{g()},500)},g=async()=>{var c;if(!S.value.trim()){A.value=[];return}b.value=!0;try{const n=await Pe({keyword:S.value,page:0,size:20});if(n.code===200){const B=(((c=n.data)==null?void 0:c.content)||[]).map(_=>{let p="未知歌手";_.artist?Array.isArray(_.artist)?p=_.artist.map(I=>typeof I=="object"&&I!==null&&(I.name||I.artistName)||String(I)).join(", "):p=_.artist:_.artists?Array.isArray(_.artists)?p=_.artists.map(I=>typeof I=="object"&&I!==null&&(I.name||I.artistName)||String(I)).join(", "):p=_.artists:_.artistName&&(p=_.artistName);const T=_.name||_.songName||_.title||"未知歌曲";return{id:_.id,name:T,cover:_.cover||_.avatar||_.picUrl||"",artist:p}});A.value=B}}catch(n){console.error("搜索歌曲失败:",n),D.error("搜索失败")}finally{b.value=!1}},J=c=>{c&&(V("select",c),z.value=!1)},E=()=>{S.value="",A.value=[],M.value="current"};return pe(z,c=>{c||E()}),(c,n)=>{const U=m("el-input"),B=m("el-icon"),_=m("el-image"),p=m("el-button"),T=m("el-empty"),I=m("el-tab-pane"),ce=m("el-tabs"),de=m("el-dialog"),oe=me("loading");return i(),W(de,{modelValue:z.value,"onUpdate:modelValue":n[3]||(n[3]=y=>z.value=y),title:"选择歌曲",width:"600px",onClose:E},{default:l(()=>[o("div",et,[o("div",tt,[s(U,{modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=y=>S.value=y),placeholder:"搜索歌曲名称或歌手","prefix-icon":"Search",clearable:"",onInput:v},null,8,["modelValue"])]),s(ce,{modelValue:M.value,"onUpdate:modelValue":n[2]||(n[2]=y=>M.value=y),onTabChange:k},{default:l(()=>[s(I,{label:"当前播放",name:"current"},{default:l(()=>[h.value?(i(),u("div",at,[o("div",{class:"song-item",onClick:n[1]||(n[1]=y=>J(h.value))},[s(_,{src:h.value.cover,fit:"cover",class:"song-cover"},{error:l(()=>[o("div",st,[s(B,null,{default:l(()=>[s(C(ve))]),_:1})])]),_:1},8,["src"]),o("div",rt,[o("div",ot,$(h.value.name),1),o("div",nt,$(h.value.artist),1)]),s(p,{type:"primary",size:"small"},{default:l(()=>[...n[4]||(n[4]=[j("选择",-1)])]),_:1})])])):(i(),u("div",lt,[s(T,{description:"当前没有播放歌曲"})]))]),_:1}),s(I,{label:"播放列表",name:"playlist"},{default:l(()=>[te((i(),u("div",it,[N.value.length===0&&!b.value?(i(),u("div",ct,[s(T,{description:"播放列表为空"})])):O("",!0),(i(!0),u(ae,null,se(N.value,y=>(i(),u("div",{key:y.id,class:"song-item",onClick:ue=>J(y)},[s(_,{src:y.cover,fit:"cover",class:"song-cover"},{error:l(()=>[o("div",ut,[s(B,null,{default:l(()=>[s(C(ve))]),_:1})])]),_:1},8,["src"]),o("div",vt,[o("div",ft,$(y.name),1),o("div",_t,$(y.artist),1)]),s(p,{type:"primary",size:"small"},{default:l(()=>[...n[5]||(n[5]=[j("选择",-1)])]),_:1})],8,dt))),128))])),[[oe,b.value]])]),_:1}),s(I,{label:"搜索",name:"search"},{default:l(()=>[te((i(),u("div",ht,[A.value.length===0&&!b.value?(i(),u("div",pt,[s(T,{description:S.value?"没有找到相关歌曲":"请输入关键词搜索"},null,8,["description"])])):O("",!0),(i(!0),u(ae,null,se(A.value,y=>(i(),u("div",{key:y.id,class:"song-item",onClick:ue=>J(y)},[s(_,{src:y.cover,fit:"cover",class:"song-cover"},{error:l(()=>[o("div",yt,[s(B,null,{default:l(()=>[s(C(ve))]),_:1})])]),_:1},8,["src"]),o("div",Ct,[o("div",wt,$(y.name),1),o("div",St,$(y.artist),1)]),s(p,{type:"primary",size:"small"},{default:l(()=>[...n[6]||(n[6]=[j("选择",-1)])]),_:1})],8,mt))),128))])),[[oe,b.value]])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}},It=he(kt,[["__scopeId","data-v-9d690710"]]),$t={class:"playlist-selector"},gt={class:"search-box"},Dt={class:"playlist-list"},bt={key:0,class:"empty-state"},Vt=["onClick"],Nt={class:"image-error"},xt={class:"playlist-info"},Tt={class:"playlist-name"},Mt={class:"playlist-desc"},At={key:0},Rt={__name:"PlaylistShareSelector",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(re,{emit:F}){const q=re,V=F,R=X({get:()=>q.modelValue,set:v=>V("update:modelValue",v)}),z=w(!1),M=w([]),S=w(""),b=X(()=>{if(!S.value)return M.value;const v=S.value.toLowerCase();return M.value.filter(g=>g.name.toLowerCase().includes(v))}),A=v=>v>=1e4?(v/1e4).toFixed(1)+"万":v,P=async()=>{z.value=!0;try{const v=await Ze();v.code===200&&(M.value=v.data||[])}catch(v){console.error("加载歌单失败:",v),D.error("加载歌单失败")}finally{z.value=!1}},h=v=>{v&&(V("select",v),R.value=!1)},N=()=>{D.info('请先在"我的歌单"页面创建歌单'),R.value=!1},k=()=>{S.value=""};return pe(R,v=>{v?P():k()}),(v,g)=>{const J=m("el-input"),E=m("el-button"),c=m("el-empty"),n=m("el-icon"),U=m("el-image"),B=m("el-dialog"),_=me("loading");return i(),W(B,{modelValue:R.value,"onUpdate:modelValue":g[1]||(g[1]=p=>R.value=p),title:"选择歌单",width:"600px",onClose:k},{default:l(()=>[o("div",$t,[o("div",gt,[s(J,{modelValue:S.value,"onUpdate:modelValue":g[0]||(g[0]=p=>S.value=p),placeholder:"搜索歌单名称","prefix-icon":"Search",clearable:""},null,8,["modelValue"])]),te((i(),u("div",Dt,[b.value.length===0&&!z.value?(i(),u("div",bt,[s(c,{description:"还没有歌单"},{default:l(()=>[s(E,{type:"primary",onClick:N},{default:l(()=>[...g[2]||(g[2]=[j("创建第一个歌单",-1)])]),_:1})]),_:1})])):O("",!0),(i(!0),u(ae,null,se(b.value,p=>(i(),u("div",{key:p.id,class:"playlist-item",onClick:T=>h(p)},[s(U,{src:p.cover,fit:"cover",class:"playlist-cover"},{error:l(()=>[o("div",Nt,[s(n,null,{default:l(()=>[s(C(ie))]),_:1})])]),_:1},8,["src"]),o("div",xt,[o("div",Tt,$(p.name),1),o("div",Mt,[o("span",null,$(p.songCount||0)+" 首歌曲",1),p.playCount?(i(),u("span",At," · "+$(A(p.playCount))+" 次播放",1)):O("",!0)])]),s(E,{type:"primary",size:"small"},{default:l(()=>[...g[3]||(g[3]=[j("选择",-1)])]),_:1})],8,Vt))),128))])),[[_,z.value]])])]),_:1},8,["modelValue"])}}},zt=he(Rt,[["__scopeId","data-v-9c08eef6"]]),Ut={class:"chat-page"},Pt={class:"conversation-list"},Lt={class:"list-header"},Ot={class:"search-box"},jt={class:"conversations"},Bt={key:0,class:"empty-state"},Ft=["onClick"],Jt={class:"conv-info"},Et={class:"conv-name"},Kt={class:"conv-message"},Ht={class:"conv-time"},Wt={class:"chat-window"},qt={key:0,class:"chat-container"},Xt={class:"chat-header"},Gt={class:"header-info"},Qt={class:"friend-name"},Yt={key:0,class:"empty-messages"},Zt={class:"message-content"},ea={key:0,class:"message-text"},ta=["onClick"],aa={class:"share-cover-error"},sa={key:1,class:"share-cover-error"},ra={class:"share-content"},oa={class:"share-title"},na={class:"share-subtitle"},la=["onClick"],ia={class:"share-cover-error"},ca={key:1,class:"share-cover-error"},da={class:"share-content"},ua={class:"share-title"},va={class:"share-subtitle"},fa={key:3,class:"message-recalled"},_a={class:"message-time"},ha={class:"chat-input"},pa={class:"input-actions"},ma={key:1,class:"empty-chat"},ya={__name:"Chat",setup(re){const F=je(),q=Ke(),V=Le(),R=qe(),z=Te(),M=w(!1),S=w(!1),b=w(!1),A=w(""),P=w([]),h=w(null),N=w(null),k=w([]),v=w(""),g=w(null),J=w(0),E=w(!0),c=w(!1),n=w(!1),U=X(()=>{if(!A.value)return P.value;const t=A.value.toLowerCase();return P.value.filter(a=>a.friendName.toLowerCase().includes(t))}),B=t=>{if(!t.lastMessage)return"暂无消息";let a=t.lastMessage;if(a==="[分享了歌曲]"||a==="[分享了歌单]")return a;if(a.startsWith("{")||a.startsWith("["))try{const e=JSON.parse(a);if(e.id&&e.title)return"[分享了歌曲]";if(e.id&&e.name)return"[分享了歌单]"}catch{}return a.length>30?a.substring(0,30)+"...":a},_=t=>{if(!t)return"";const a=new Date(t),d=new Date-a,f=Math.floor(d/(1e3*60*60*24));return f===0?a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):f===1?"昨天":f<7?`${f}天前`:a.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},p=t=>t?new Date(t).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):"",T=async()=>{M.value=!0;try{const t=await Xe();t.code===200&&(P.value=t.data||[])}catch(t){console.error("加载会话列表失败:",t)}finally{M.value=!1}},I=()=>{T(),R.loadConversations()},ce=t=>{Number(F.params.id)!==t.friendId&&q.push(`/chat/${t.friendId}`)},de=async(t,a=!0)=>{a&&(J.value=0,k.value=[],E.value=!0),S.value=!0;try{const e=await Qe(t,{page:J.value,size:50});if(e.code===200){const d=e.data,f=(d.content||[]).map(x=>{if((x.type==="song"||x.type==="playlist")&&x.content&&!x.shareData)try{x.shareData=JSON.parse(x.content)}catch(K){console.error("解析分享数据失败:",K)}return x});a?k.value=f.reverse():k.value=[...f.reverse(),...k.value],E.value=!d.first,await Z(),G()}}catch(e){console.error("加载聊天记录失败:",e)}finally{S.value=!1}},oe=async t=>{if(!(!t||!t.id)){try{await We.confirm("确定撤回这条消息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch{return}try{(await Ye(t.id)).code===200&&(t.isRecalled=!0,t.type==="text"&&(t.content=""),D.success("已撤回"))}catch(a){console.error("撤回消息失败:",a),D.error("撤回失败")}}},y=async()=>{var t;if(!(!v.value.trim()||!h.value)){b.value=!0;try{const a={receiverId:h.value,type:"text",content:v.value.trim()};ee.sendChatMessage(a);const e=`tmp-${Date.now()}`;k.value.push({clientId:e,local:!0,senderId:(t=V.userInfo)==null?void 0:t.id,receiverId:h.value,type:"text",content:a.content,createTime:new Date().toISOString(),isRecalled:!1}),v.value="",await Z(),G(),await T()}catch(a){console.error("发送消息失败:",a)}finally{b.value=!1}}},ue=()=>{if(!h.value){D.warning("请先选择聊天对象");return}c.value=!0},Me=()=>{if(!h.value){D.warning("请先选择聊天对象");return}n.value=!0},Ae=async t=>{var a;if(!(!t||!h.value)){b.value=!0;try{const e={receiverId:h.value,type:"song",content:JSON.stringify({id:t.id,name:t.name,artist:t.artist,cover:t.cover})};ee.sendChatMessage(e);const d=`tmp-${Date.now()}`;k.value.push({clientId:d,local:!0,senderId:(a=V.userInfo)==null?void 0:a.id,receiverId:h.value,type:"song",content:e.content,shareData:{id:t.id,name:t.name,artist:t.artist,cover:t.cover},createTime:new Date().toISOString(),isRecalled:!1}),await Z(),G(),await T(),D.success("分享成功")}catch(e){console.error("分享歌曲失败:",e),D.error("分享失败")}finally{b.value=!1}}},Re=async t=>{var a;if(!(!t||!h.value)){b.value=!0;try{const e={receiverId:h.value,type:"playlist",content:JSON.stringify({id:t.id,name:t.name,cover:t.cover,songCount:t.songCount})};ee.sendChatMessage(e);const d=`tmp-${Date.now()}`;k.value.push({clientId:d,local:!0,senderId:(a=V.userInfo)==null?void 0:a.id,receiverId:h.value,type:"playlist",content:e.content,shareData:{id:t.id,name:t.name,cover:t.cover,songCount:t.songCount},createTime:new Date().toISOString(),isRecalled:!1}),await Z(),G(),await T(),D.success("分享成功")}catch(e){console.error("分享歌单失败:",e),D.error("分享失败")}finally{b.value=!1}}},ze=async t=>{var a;if(!t.shareData&&t.content)try{t.shareData=JSON.parse(t.content)}catch(e){console.error("解析歌曲数据失败:",e),D.error("歌曲数据解析失败");return}if(console.log("点击分享的歌曲:",t.shareData),!((a=t.shareData)!=null&&a.id)){D.warning("歌曲信息不完整");return}try{if(t.shareData.url)z.play(t.shareData),D.success("开始播放");else{D.info("正在加载歌曲...");const{getMusicDetail:e}=await He(async()=>{const{getMusicDetail:f}=await import("./index-nrl4pEAu.js").then(x=>x.ie);return{getMusicDetail:f}},__vite__mapDeps([0,1])),d=await e(t.shareData.id);if(d.code===200&&d.data){const f={...t.shareData,...d.data};z.play(f),D.success("开始播放")}else D.error("获取歌曲信息失败")}}catch(e){console.error("播放歌曲失败:",e),D.error("播放失败")}},Ue=t=>{var a;if(!t.shareData&&t.content)try{t.shareData=JSON.parse(t.content)}catch(e){console.error("解析歌单数据失败:",e)}(a=t.shareData)!=null&&a.id&&q.push(`/playlist/${t.shareData.id}`)},G=()=>{g.value&&(g.value.scrollTop=g.value.scrollHeight)};return pe(()=>F.params.id,async t=>{if(t){const a=Number(t);h.value=a;const e=P.value.find(d=>d.friendId===a);e&&(N.value={id:a,nickname:e.friendName,avatar:e.friendAvatar}),await de(a,!0);try{await xe(a),await R.updateUnreadMessageCount(),(!e||e.unreadCount>0)&&await T()}catch{}if(!N.value||N.value.id!==a)try{const d=await Ge();if(d.code===200){const f=d.data.find(x=>x.friendId===a);f&&(N.value=f.friend||{id:a,nickname:f.friendName,avatar:f.friendAvatar})}}catch{}}else h.value=null,N.value=null,k.value=[]},{immediate:!0}),Oe(async()=>{if(await T(),F.params.id&&!N.value){const e=Number(F.params.id),d=P.value.find(f=>f.friendId===e);d&&(N.value={id:e,nickname:d.friendName,avatar:d.friendAvatar})}const t=ee.onChatMessage(async e=>{try{if(!e)return;await T()}catch(d){console.error("更新会话列表失败:",d)}}),a=ee.onChatMessage(async e=>{var d;try{if(!e||!h.value)return;const f=h.value;if(e.senderId===f||e.receiverId===f){if((e.type==="song"||e.type==="playlist")&&e.content&&!e.shareData)try{e.shareData=JSON.parse(e.content)}catch(H){console.error("解析分享数据失败:",H)}if(e.senderId===((d=V.userInfo)==null?void 0:d.id)){const H=(L,ne)=>{const r=new Date(L).getTime(),Y=new Date(ne).getTime();return Math.abs(r-Y)<1e4},Q=k.value.findIndex(L=>L.local===!0&&L.senderId===e.senderId&&L.receiverId===e.receiverId&&L.type===e.type&&L.content===e.content&&L.createTime&&e.createTime&&H(L.createTime,e.createTime));Q!==-1?k.value[Q]={...e}:k.value.push(e)}else if(k.value.push(e),e.id&&e.senderId===f)try{await xe(f),await R.updateUnreadMessageCount(),await T()}catch(H){console.error("标记已读失败:",H)}await Z(),G()}}catch{}});Be(()=>{typeof a=="function"&&a(),typeof t=="function"&&t()})}),(t,a)=>{const e=m("el-icon"),d=m("el-button"),f=m("el-input"),x=m("el-empty"),K=m("el-avatar"),H=m("el-badge"),Q=m("el-image"),L=m("el-button-group"),ne=me("loading");return i(),u("div",Ut,[o("div",Pt,[o("div",Lt,[a[4]||(a[4]=o("h3",null,"聊天",-1)),s(d,{text:"",onClick:I},{default:l(()=>[s(e,null,{default:l(()=>[s(C(Fe))]),_:1})]),_:1})]),o("div",Ot,[s(f,{modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=r=>A.value=r),placeholder:"搜索好友","prefix-icon":"Search",clearable:""},null,8,["modelValue"])]),te((i(),u("div",jt,[U.value.length===0&&!M.value?(i(),u("div",Bt,[s(x,{description:"暂无会话"})])):O("",!0),(i(!0),u(ae,null,se(U.value,r=>(i(),u("div",{key:r.id,class:_e(["conversation-item",{active:h.value===r.friendId}]),onClick:Y=>ce(r)},[s(H,{value:r.unreadCount,hidden:!r.unreadCount,max:99,class:"conversation-badge"},{default:l(()=>[s(K,{src:r.friendAvatar,size:45},{default:l(()=>[s(e,null,{default:l(()=>[s(C(le))]),_:1})]),_:1},8,["src"])]),_:2},1032,["value","hidden"]),o("div",Jt,[o("div",Et,$(r.friendName),1),o("div",Kt,$(B(r)),1)]),o("div",Ht,$(_(r.lastMessageTime)),1)],10,Ft))),128))])),[[ne,M.value]])]),o("div",Wt,[N.value?(i(),u("div",qt,[o("div",Xt,[s(K,{src:N.value.avatar,size:40},{default:l(()=>[s(e,null,{default:l(()=>[s(C(le))]),_:1})]),_:1},8,["src"]),o("div",Gt,[o("div",Qt,$(N.value.nickname||N.value.username),1),a[5]||(a[5]=o("div",{class:"friend-status"},"在线",-1))])]),te((i(),u("div",{ref_key:"messageListRef",ref:g,class:"message-list"},[k.value.length===0&&!S.value?(i(),u("div",Yt,[s(x,{description:"开始聊天吧~"})])):O("",!0),(i(!0),u(ae,null,se(k.value,r=>{var Y,ye,Ce,we,Se,ke,Ie,$e,ge,De,be,Ve;return i(),u("div",{key:r.id||r.clientId,class:_e(["message-item",{"is-self":r.senderId===((Y=C(V).userInfo)==null?void 0:Y.id)}])},[r.senderId!==((ye=C(V).userInfo)==null?void 0:ye.id)?(i(),W(K,{key:0,src:r.senderAvatar,size:35},{default:l(()=>[s(e,null,{default:l(()=>[s(C(le))]),_:1})]),_:1},8,["src"])):O("",!0),o("div",Zt,[o("div",{class:_e(["message-bubble",{"is-self":r.senderId===((Ce=C(V).userInfo)==null?void 0:Ce.id)}])},[r.type==="text"&&!r.isRecalled?(i(),u("div",ea,$(r.content),1)):r.type==="song"&&!r.isRecalled?(i(),u("div",{key:1,class:"message-share",onClick:Ne=>ze(r)},[(we=r.shareData)!=null&&we.cover?(i(),W(Q,{key:0,src:r.shareData.cover,fit:"cover",class:"share-cover"},{error:l(()=>[o("div",aa,[s(e,null,{default:l(()=>[s(C(fe))]),_:1})])]),_:1},8,["src"])):(i(),u("div",sa,[s(e,null,{default:l(()=>[s(C(fe))]),_:1})])),o("div",ra,[o("div",oa,$(((Se=r.shareData)==null?void 0:Se.name)||"歌曲"),1),o("div",na,$(((ke=r.shareData)==null?void 0:ke.artist)||""),1)])],8,ta)):r.type==="playlist"&&!r.isRecalled?(i(),u("div",{key:2,class:"message-share",onClick:Ne=>Ue(r)},[(Ie=r.shareData)!=null&&Ie.cover?(i(),W(Q,{key:0,src:r.shareData.cover,fit:"cover",class:"share-cover"},{error:l(()=>[o("div",ia,[s(e,null,{default:l(()=>[s(C(ie))]),_:1})])]),_:1},8,["src"])):(i(),u("div",ca,[s(e,null,{default:l(()=>[s(C(ie))]),_:1})])),o("div",da,[o("div",ua,$((($e=r.shareData)==null?void 0:$e.name)||"歌单"),1),o("div",va,$(((ge=r.shareData)==null?void 0:ge.songCount)||0)+" 首歌曲",1)])],8,la)):O("",!0),r.isRecalled?(i(),u("div",fa," [消息已撤回] ")):O("",!0)],2),o("div",_a,[j($(p(r.createTime))+" ",1),r.senderId===((De=C(V).userInfo)==null?void 0:De.id)&&!r.isRecalled&&r.id?(i(),W(d,{key:0,text:"",size:"small",class:"recall-btn",onClick:Ne=>oe(r)},{default:l(()=>[...a[6]||(a[6]=[j("撤回",-1)])]),_:1},8,["onClick"])):O("",!0)])]),r.senderId===((be=C(V).userInfo)==null?void 0:be.id)?(i(),W(K,{key:1,src:(Ve=C(V).userInfo)==null?void 0:Ve.avatar,size:35},{default:l(()=>[s(e,null,{default:l(()=>[s(C(le))]),_:1})]),_:1},8,["src"])):O("",!0)],2)}),128))])),[[ne,S.value]]),o("div",ha,[s(f,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=r=>v.value=r),type:"textarea",rows:3,placeholder:"输入消息...",maxlength:"2000","show-word-limit":"",resize:"none",onKeyup:Je(Ee(y,["ctrl"]),["enter"])},null,8,["modelValue","onKeyup"]),o("div",pa,[s(L,null,{default:l(()=>[s(d,{text:"",onClick:ue},{default:l(()=>[s(e,null,{default:l(()=>[s(C(fe))]),_:1}),a[7]||(a[7]=j(" 分享歌曲 ",-1))]),_:1}),s(d,{text:"",onClick:Me},{default:l(()=>[s(e,null,{default:l(()=>[s(C(ie))]),_:1}),a[8]||(a[8]=j(" 分享歌单 ",-1))]),_:1})]),_:1}),s(d,{type:"primary",onClick:y,loading:b.value,disabled:!v.value.trim()},{default:l(()=>[...a[9]||(a[9]=[j(" 发送 ",-1)])]),_:1},8,["loading","disabled"])])])])):(i(),u("div",ma,[s(x,{description:"选择一个好友开始聊天"})]))]),s(It,{modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=r=>c.value=r),onSelect:Ae},null,8,["modelValue"]),s(zt,{modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=r=>n.value=r),onSelect:Re},null,8,["modelValue"])])}}},Ia=he(ya,[["__scopeId","data-v-2e01655f"]]);export{Ia as default};
