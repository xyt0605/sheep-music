import{_ as v,c as x,o as F,a as g,d as s,w as t,r as d,g as c,h as R,E as w,u as k,e as p,t as y}from"./index-LKNASSCX.js";import{r as b}from"./user-CatBsr9t.js";import"./request-BJQTzVY9.js";const E={name:"Register",setup(){const f=k(),r=c(null),u=c(!1),e=R({username:"",password:"",confirmPassword:"",nickname:"",email:""});return{registerFormRef:r,registerForm:e,registerRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度为3-20个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度为6-20个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:(m,a,l)=>{a===""?l(new Error("请再次输入密码")):a!==e.password?l(new Error("两次输入的密码不一致")):l()},trigger:"blur"}],email:[{validator:(m,a,l)=>{a===""||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?l():l(new Error("请输入正确的邮箱格式"))},trigger:"blur"}]},loading:u,handleRegister:async()=>{r.value&&await r.value.validate(async m=>{if(m)try{u.value=!0,await b({username:e.username,password:e.password,nickname:e.nickname||e.username,email:e.email}),w.success("注册成功，请登录"),setTimeout(()=>{f.push("/login")},1e3)}catch(a){w.error(a.message||"注册失败")}finally{u.value=!1}})}}}},z={class:"register-container"},P={class:"register-box"},C={class:"login-link"};function U(f,r,u,e,_,V){const n=d("el-input"),i=d("el-form-item"),m=d("el-button"),a=d("router-link"),l=d("el-form");return F(),x("div",z,[g("div",P,[r[7]||(r[7]=g("h2",{class:"title"},"Sheep Music",-1)),r[8]||(r[8]=g("p",{class:"subtitle"},"创建新账号",-1)),s(l,{ref:"registerFormRef",model:e.registerForm,rules:e.registerRules,class:"register-form"},{default:t(()=>[s(i,{prop:"username"},{default:t(()=>[s(n,{modelValue:e.registerForm.username,"onUpdate:modelValue":r[0]||(r[0]=o=>e.registerForm.username=o),placeholder:"请输入用户名（3-20个字符）","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password"},{default:t(()=>[s(n,{modelValue:e.registerForm.password,"onUpdate:modelValue":r[1]||(r[1]=o=>e.registerForm.password=o),type:"password",placeholder:"请输入密码（6-20个字符）","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),s(i,{prop:"confirmPassword"},{default:t(()=>[s(n,{modelValue:e.registerForm.confirmPassword,"onUpdate:modelValue":r[2]||(r[2]=o=>e.registerForm.confirmPassword=o),type:"password",placeholder:"请再次输入密码","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),s(i,{prop:"nickname"},{default:t(()=>[s(n,{modelValue:e.registerForm.nickname,"onUpdate:modelValue":r[3]||(r[3]=o=>e.registerForm.nickname=o),placeholder:"请输入昵称（可选）","prefix-icon":"Avatar",size:"large"},null,8,["modelValue"])]),_:1}),s(i,{prop:"email"},{default:t(()=>[s(n,{modelValue:e.registerForm.email,"onUpdate:modelValue":r[4]||(r[4]=o=>e.registerForm.email=o),placeholder:"请输入邮箱（可选）","prefix-icon":"Message",size:"large"},null,8,["modelValue"])]),_:1}),s(i,null,{default:t(()=>[s(m,{type:"primary",size:"large",loading:e.loading,onClick:e.handleRegister,class:"register-button"},{default:t(()=>[p(y(e.loading?"注册中...":"注册"),1)]),_:1},8,["loading","onClick"])]),_:1}),g("div",C,[r[6]||(r[6]=p(" 已有账号？ ",-1)),s(a,{to:"/login"},{default:t(()=>[...r[5]||(r[5]=[p("立即登录",-1)])]),_:1})])]),_:1},8,["model","rules"])])])}const N=v(E,[["render",U],["__scopeId","data-v-66e24095"]]);export{N as default};
